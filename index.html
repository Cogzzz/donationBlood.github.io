<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PMI Blood Heroes - Blood Donation Educational Game</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <!-- Slick Slider -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
    <style>
      .hero-slider .slick-slide {
        height: 500px;
      }
      .hero-slider .slick-dots {
        bottom: 25px;
      }
      .hero-slider .slick-dots li button:before {
        color: white;
        font-size: 12px;
        opacity: 0.7;
      }
      .hero-slider .slick-dots li.slick-active button:before {
        color: white;
        opacity: 1;
      }
      .hero-slider .slick-arrow {
        z-index: 10;
      }
      .hero-slider .slick-prev {
        left: 20px;
      }
      .hero-slider .slick-next {
        right: 20px;
      }
      .hero-slider .slick-prev:before,
      .hero-slider .slick-next:before {
        font-size: 24px;
      }
      .slide-badge {
        display: inline-block;
        background-color: rgba(220, 38, 38, 0.9);
        padding: 4px 12px;
        border-radius: 9999px;
        font-size: 0.875rem;
        font-weight: 600;
        margin-bottom: 1rem;
      }
      .card-animate {
        opacity: 0;
        animation: fadeIn 0.8s ease-in forwards;
      }
      
      .card-animate:nth-child(1) {
        animation-delay: 100ms;
      }
      
      .card-animate:nth-child(2) {
        animation-delay: 300ms;
      }
      
      .card-animate:nth-child(3) {
        animation-delay: 500ms;
      }
      
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      #simulation {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .scene {
      width: 100%;
      height: 450px;
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      position: relative;
      overflow: hidden;
  }
  .scene-content {
      width: 100%;
      height: 100%;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
  }
  .controls {
      background-color: #f8f8f8;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 5px;
  }
  .item {
      width: 60px;
      height: 60px;
      cursor: pointer;
      display: inline-block;
      margin: 5px;
      border: 2px solid transparent;
      border-radius: 5px;
      padding: 5px;
      transition: all 0.3s;
  }
  .item:hover {
      border-color: #d32f2f;
      background-color: #ffebee;
  }
  .selected {
      border-color: #d32f2f;
      box-shadow: 0 0 5px #d32f2f;
      background-color: #ffebee;
  }
  .patient {
      position: relative;
      height: 350px;
      width: 200px;
  }
  .arm {
      position: absolute;
      top: 100px;
      right: -30px;
      cursor: pointer;
  }
  .vein {
      stroke: #5c6bc0;
      stroke-width: 3;
      stroke-opacity: 0.7;
  }
  .blood-sample {
      position: absolute;
      display: none;
  }
  .test-result {
      width: 120px;
      height: 60px;
      background-color: #fff;
      border: 1px solid #ccc;
      position: absolute;
      top: 50px;
      right: 50px;
      font-size: 14px;
      padding: 5px;
      text-align: center;
      display: none;
      border-radius: 5px;
  }
  .patient-target {
      position: relative;
      height: 350px;
      width: 200px;
      display: none;
  }
  .blood-bag {
      position: absolute;
      display: none;
      cursor: grab;
  }
  .progress-container {
      width: 100%;
      background-color: #e0e0e0;
      border-radius: 5px;
      margin-top: 20px;
  }
  .progress-bar {
      width: 0;
      height: 20px;
      background-color: #d32f2f;
      border-radius: 5px;
      text-align: center;
      line-height: 20px;
      color: white;
  }
  .message {
      background-color: #fff;
      padding: 10px;
      margin-top: 10px;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      font-weight: bold;
      text-align: center;
  }
  .btn {
      background-color: #d32f2f;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
      font-weight: bold;
      transition: background-color 0.3s;
  }
  .btn:hover {
      background-color: #b71c1c;
  }
  .btn:disabled {
      background-color: #e0e0e0;
      cursor: not-allowed;
  }
  .fade-in {
      animation: fadeIn 0.5s;
  }
  @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
  }
  .fade-out {
      animation: fadeOut 0.5s;
  }
  @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
  }
  .transition-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      color: white;
      font-size: 24px;
      text-align: center;
      z-index: 100;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s;
  }
  .transition-overlay.active {
      opacity: 1;
      pointer-events: all;
  }
  .stage-title {
      font-size: 32px;
      margin-bottom: 20px;
      color: #ff5252;
  }
  .stage-desc {
      font-size: 18px;
      max-width: 80%;
      line-height: 1.5;
  }
  .laboratory {
      background-color: #f5f5f5;
      width: 100%;
      height: 100%;
      display: none;
      position: relative;
      background-image: linear-gradient(to bottom, #f5f5f5, #e0e0e0);
  }
  .lab-table {
      width: 80%;
      height: 200px;
      background-color: #e0e0e0;
      position: absolute;
      bottom: 50px;
      left: 10%;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      border: 1px solid #bdbdbd;
  }
  .transfusion-room {
      background-color: #e8f5e9;
      width: 100%;
      height: 100%;
      display: none;
      position: relative;
      background-image: linear-gradient(to bottom, #e8f5e9, #c8e6c9);
  }
  .transfusion-stand {
      transition: filter 0.3s ease;
  }
  .alert {
      padding: 15px;
      color: white;
      background-color: #4CAF50;
      border-radius: 5px;
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
      display: none;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  }
  svg {
      display: block;
  }
  .blood-flow {
      stroke-dasharray: 10, 5;
      animation: flow 5s linear infinite;
  }
  @keyframes flow {
      from {
          stroke-dashoffset: 1000;
      }
      to {
          stroke-dashoffset: 0;
      }
  }
  
  @keyframes pulse {
      from { r: 5; fill: #e53935; }
      to { r: 7; fill: #c62828; }
  }
  .blood-drop-animation {
      position: absolute;
      width: 20px;
      height: 20px;
      background-color: #e53935;
      border-radius: 50% 50% 50% 0;
      transform: rotate(-45deg);
      animation: dropBlood 1s forwards;
  }
  
  @keyframes dropBlood {
      0% {
          transform: translate(-50%, -100%) rotate(-45deg);
          opacity: 1;
      }
      100% {
          transform: translate(-50%, 0) rotate(-45deg);
          opacity: 0;
      }
  }
  /* Tambahkan style untuk visualisasi yang lebih jelas pada penggumpalan */
  .coagulation-positive {
      animation: pulseCoagulation 1.5s infinite;
  }
  
  @keyframes pulseCoagulation {
      0% { fill-opacity: 0.5; }
      50% { fill-opacity: 0.9; }
      100% { fill-opacity: 0.5; }
  }
  
  /* Style untuk drop-zone yang lebih jelas */
  .drop-zone-highlight {
      stroke-dasharray: 5;
      animation: dash 2s linear infinite;
  }
  
  .drop-zone-active {
      fill: rgba(255, 235, 238, 0.7);
      stroke: #b71c1c;
      stroke-width: 4;
  }
  
  @keyframes dash {
      to {
          stroke-dashoffset: 20;
      }
  }
  
  @keyframes pulseBorder {
      0% { border-color: #ff1744; }
      50% { border-color: #ff616f; }
      100% { border-color: #ff1744; }
  }
  
  /* Highlight untuk transfusion stand */
  .stand-highlight {
      filter: drop-shadow(0 0 5px rgba(255, 23, 68, 0.7));
  }

  /* Additional styles for the simulation tabs */
  .sim-tabs {
      display: flex;
      margin-bottom: 1rem;
      border-bottom: 1px solid #e0e0e0;
  }
  
  .sim-tab {
      background-color: #f5f5f5;
      color: #333;
      padding: 10px 20px;
      border-radius: 5px 5px 0 0;
      border: 1px solid #e0e0e0;
      border-bottom: none;
      margin-right: 5px;
      cursor: pointer;
      transition: all 0.3s;
  }
  
  .sim-tab.active {
      background-color: #d32f2f;
      color: white;
      border-color: #b71c1c;
  }
  
  .sim-tab:hover:not(.active) {
      background-color: #eeeeee;
  }

  /* Responsive design */
  @media (max-width: 768px) {
      .scene {
          height: 350px;
      }
      
      .controls {
          flex-wrap: wrap;
      }
      
      .item {
          width: 50px;
          height: 50px;
      }
  }

  .blood-type-btn.selected, .rh-btn.selected {
    background-color: #fee2e2;
    border-color: #ef4444;
    border-width: 2px;
    box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.3);
    transform: scale(1.05);
}

/* Animasi untuk penggumpalan darah */
@keyframes coagulationPulse {
    0% { opacity: 0.6; }
    50% { opacity: 1; }
    100% { opacity: 0.6; }
}

.coagulation-positive {
    animation: coagulationPulse 2s infinite;
}

/* Efek flash saat jawaban salah */
@keyframes flashError {
    0% { background-color: #fff; }
    50% { background-color: #fee2e2; }
    100% { background-color: #fff; }
}

.flash-error {
    animation: flashError 0.6s ease-in-out;
}

/* Efek muncul untuk interface pemilihan golongan darah */
@keyframes fadeIn {
    0% { opacity: 0; transform: translateY(10px); }
    100% { opacity: 1; transform: translateY(0); }
}

.fade-in {
    animation: fadeIn 0.5s ease-out forwards;
}

/* Efek sukses untuk hasil tes yang benar */
@keyframes successPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.success-pulse {
    animation: successPulse 1s ease-in-out;
}

/* Efek hover untuk tombol */
.blood-type-btn:hover, .rh-btn:hover {
    background-color: #fee2e2;
    border-color: #ef4444;
    transform: translateY(-2px);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

/* Styling tambahan untuk tampilan hasil tes */
#test-result-display {
    transform-origin: center;
    transition: all 0.3s ease;
}

#test-result-display.show {
    opacity: 1;
    transform: scale(1);
}

/* Efek tetesan darah tambahan */
.blood-drop {
    position: absolute;
    width: 10px;
    height: 15px;
    background-color: #ef4444;
    border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
    animation: dropAnimation 1.5s forwards;
}

@keyframes dropAnimation {
    0% { transform: translateY(-20px); opacity: 0; }
    20% { opacity: 1; }
    100% { transform: translateY(100px); opacity: 0; }
}

/* Kotak bantuan dengan efek bayangan */
.helper-box {
    border-left: 4px solid #3b82f6;
    background-color: #eff6ff;
    padding: 1rem;
    margin-bottom: 1rem;
    border-radius: 0.375rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

/* Efek hover pada tombol konfirmasi */
#btn-confirm {
    transition: all 0.3s ease;
}

#btn-confirm:hover {
    box-shadow: 0 4px 6px rgba(239, 68, 68, 0.25);
}
    </style>
  </head>
  <body class="bg-gray-50 font-sans min-h-screen flex flex-col">
    <header class="bg-white text-black shadow-md sticky top-0 z-50">
      <div class="container mx-auto px-4 py-3 flex justify-between items-center">
          <div class="flex items-center space-x-2">
              <img src="img/blood.png" alt="Blood Heroes Logo" class="h-8 w-8 rounded-full object-cover" />
              <span class="font-bold text-xl">PMI Blood Heroes</span>
          </div>
          <nav class="hidden md:block">
              <ul class="flex space-x-6">
                  <li><a href="index.html" class="hover:text-red-600 transition duration-300">Home</a></li>
                  <li><a href="index.html" class="hover:text-red-600 transition duration-300">Games</a></li>
                  <li><a href="index.html" class="hover:text-red-600 transition duration-300">Education</a></li>
                  <li><a href="index.html" class="hover:text-red-600 transition duration-300">Leaderboard</a></li>
                  <li><a href="index.html" class="hover:text-red-600 transition duration-300">Blood Stock</a></li>
              </ul>
          </nav>
          <div class="flex items-center space-x-3">
              <!-- Profile container with fixed positioning for dropdown -->
              <div class="profile-container relative">
                  <button id="profileButton" class="block focus:outline-none">
                      <div class="relative w-10 h-10 rounded-full overflow-hidden">
                          <img src="img/user.png" alt="User Profile" class="w-full h-full object-cover" />
                      </div>
                  </button>
                  
                  <!-- Dropdown Menu - Fixed right alignment -->
                    <div id="dropdownMenu" class="dropdown-menu hidden absolute right-0 top-12 bg-white rounded-lg shadow-lg w-64 z-50 border border-black">
                      <div class="user-info flex items-center p-4 border-b border-gray-200">
                          <div class="w-10 h-10 rounded-full overflow-hidden mr-3">
                              <img src="img/user.png" alt="User Profile" class="w-full h-full object-cover" />
                          </div>
                          <div class="user-details">
                              <span class="font-semibold text-sm">Budi Budiman</span>
                          </div>
                      </div>
                      
                      <a href="profile.html" class="dropdown-item flex items-center px-4 py-3 text-gray-800 hover:bg-gray-100 text-sm">
                          <span class="mr-3 w-5 text-center">👤</span> Profile
                      </a>
                      
                      <a href="reward.html" class="dropdown-item flex items-center px-4 py-3 text-blue-500 hover:bg-gray-100 text-sm">
                          <span class="mr-3 w-5 text-center">🪙</span> Reedem Points
                      </a>
  
                      <div class="border-t border-gray-200 my-1"></div>
                  
                      <a href="#" class="dropdown-item flex items-center px-4 py-3 text-gray-800 hover:bg-gray-100 text-sm">
                          <span class="mr-3 w-5 text-center">❌</span> Log out
                      </a>
                      
                        <div class="flex justify-start p-4">
                          <div class="w-10 h-10 rounded-full overflow-hidden">
                            <i class="fas fa-coins text-yellow-500 text-3xl"></i>
                          </div>
                          <span class="font-medium text-sm ml-3">304 Points</span>
                        </div>
                  </div>
              </div>
              <!-- Mobile menu toggle button - Moved inside the right-side flex container -->
              <button class="md:hidden text-gray-700 focus:outline-none" id="mobile-menu-button">
                  <i class="fas fa-bars text-xl"></i>
              </button>
          </div>
      </div>
      <!-- Mobile menu (hidden by default) -->
      <div class="md:hidden hidden bg-white px-4 py-2" id="mobile-menu">
          <ul class="space-y-2">
              <li><a href="#home" class="block py-2 hover:text-red-400">Home</a></li>
              <li><a href="#games" class="block py-2 hover:text-red-400">Games</a></li>
              <li><a href="#education" class="block py-2 hover:text-red-400">Education</a></li>
              <li><a href="#leaderboard" class="block py-2 hover:text-red-400">Leaderboard</a></li>
              <li><a href="#blood-stock" class="block py-2 hover:text-red-400">Blood Stock</a></li>
          </ul>
      </div>
  </header>

  <section class="hero-slider" id="home">
    <!-- Slide 1 -->
    <div class="relative h-full">
      <div class="absolute inset-0 bg-cover bg-center" style="background-image: url('img/hospital.png')"></div>
      <div class="absolute inset-0 bg-black opacity-50"></div>
      <div class="container mx-auto px-4 h-full flex items-center justify-center">
        <div class="relative z-10 max-w-3xl text-center text-white">
          <span class="slide-badge">Join Today</span>
          <h1 class="text-4xl md:text-5xl font-bold mb-6">Become a Blood Donation Hero</h1>
          <p class="text-xl mb-8">
            Play and learn about the importance of blood donation. Earn points, challenge friends, and discover how one
            blood bag can save up to three lives!
          </p>
          <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-4">
            <a
              href="#games"
              class="bg-white text-red-600 font-bold py-3 px-8 rounded-full shadow-lg hover:bg-gray-100 transition duration-300"
              >Start Playing</a
            >
            <a
              href="#education"
              class="bg-transparent border-2 border-white py-3 px-8 rounded-full hover:bg-white hover:text-red-600 transition duration-300"
              >Learn About Blood Donation</a
            >
          </div>
        </div>
      </div>
    </div>

    <!-- Slide 2 -->
    <div class="relative h-full">
      <div class="absolute inset-0 bg-cover bg-center" style="background-image: url('img/donors.jpg')"></div>
      <div class="absolute inset-0 bg-black opacity-50"></div>
      <div class="container mx-auto px-4 h-full flex items-center justify-center">
        <div class="relative z-10 max-w-3xl text-center text-white">
          <span class="slide-badge">Did You Know?</span>
          <h1 class="text-4xl md:text-5xl font-bold mb-6">One Donation Saves 3 Lives</h1>
          <p class="text-xl mb-8">
            Your single donation can be separated into red cells, platelets, and plasma
            to help multiple patients with different medical needs.
          </p>
          <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-4">
            <a
              href="donasi.html"
              class="bg-white text-red-600 font-bold py-3 px-8 rounded-full shadow-lg hover:bg-gray-100 transition duration-300"
              >Schedule Donation</a
            >
          </div>
        </div>
      </div>
    </div>

    <!-- Slide 3 -->
    <div class="relative h-full">
      <div class="absolute inset-0 bg-cover bg-center" style="background-image: url('img/points.png')"></div>
      <div class="absolute inset-0 bg-black opacity-50"></div>
      <div class="container mx-auto px-4 h-full flex items-center justify-center">
        <div class="relative z-10 max-w-3xl text-center text-white">
          <span class="slide-badge">Donor Rewards</span>
          <h1 class="text-4xl md:text-5xl font-bold mb-6">Earn Points While Saving Lives</h1>
          <p class="text-xl mb-8">
            Join our Donor Rewards Program and earn points for each donation.
            Redeem them for exclusive merchandise, gift cards, and more!
          </p>
          <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-4">
            <a
              href="reward.html"
              class="bg-white text-red-600 font-bold py-3 px-8 rounded-full shadow-lg hover:bg-gray-100 transition duration-300"
              >View Rewards</a
            >
          </div>
        </div>
      </div>
    </div>
  </section>

    <section class="py-16 px-4 bg-white">
      <div class="container mx-auto">
        <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Main Features</h2>
        <div class="grid md:grid-cols-3 gap-8">
          <!-- Card 1 -->
          <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 ease-in transform hover:-translate-y-1 card-animate">
            <div class="bg-red-100 p-6 text-center">
              <i class="fas fa-gamepad text-4xl text-red-600"></i>
            </div>
            <div class="p-6">
              <h3 class="text-xl font-bold text-gray-800 mb-3">Blood Donation Simulation</h3>
              <p class="text-gray-600 mb-4">
                Experience what it's like to be a medical professional managing the blood donation process, from
                screening to distribution.
              </p>
              <a
                href="#simulation"
                class="block text-center bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition duration-300"
                >Play Now</a
              >
            </div>
          </div>
        
          <!-- Card 2 -->
          <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 ease-in transform hover:-translate-y-1 card-animate">
            <div class="bg-red-100 p-6 text-center">
              <i class="fas fa-question-circle text-4xl text-red-600"></i>
            </div>
            <div class="p-6">
              <h3 class="text-xl font-bold text-gray-800 mb-3">Interactive Quiz</h3>
              <p class="text-gray-600 mb-4">
                Test your knowledge about blood donation through quizzes with various difficulty levels and earn virtual
                rewards.
              </p>
              <a
                href="#quiz"
                class="block text-center bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition duration-300"
                >Play Now</a
              >
            </div>
          </div>
        
          <!-- Card 3 -->
          <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 ease-in transform hover:-translate-y-1 card-animate">
            <div class="bg-red-100 p-6 text-center">
              <i class="fas fa-book-medical text-4xl text-red-600"></i>
            </div>
            <div class="p-6">
              <h3 class="text-xl font-bold text-gray-800 mb-3">Educational Materials</h3>
              <p class="text-gray-600 mb-4">
                Learn about different blood products, blood needs, storage, processing, and blood donation activities.
              </p>
              <a
                href="#education"
                class="block text-center bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition duration-300"
                >Learn More</a
              >
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="py-16 px-4 bg-white" id="games">
      <div class="container mx-auto">
        <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Educational Games</h2>

        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
          <div class="flex border-b">
            <button
              class="py-4 px-6 font-medium text-gray-800 bg-gray-200 hover:bg-gray-300 transition duration-300 focus:outline-none"
              id="sim-tab"
            >
              Blood Donation Simulation
            </button>
            <button
              class="py-4 px-6 font-medium text-gray-800 hover:bg-gray-200 transition duration-300 focus:outline-none"
              id="quiz-tab"
            >
              Interactive Quiz
            </button>
          </div>

          <div id="simulation">
            <div class="scene">
                <div class="scene-content" id="scene-content">
                    <div class="patient">
                        <svg width="200" height="350" viewBox="0 0 200 350">
                            <!-- Patient body -->
                            <rect x="50" y="50" width="100" height="200" rx="20" fill="#ffccbc" />
                            <!-- Patient head -->
                            <circle cx="100" cy="30" r="30" fill="#ffccbc" />
                            <!-- Patient details -->
                            <circle cx="90" cy="25" r="3" fill="#424242" /> <!-- Left eye -->
                            <circle cx="110" cy="25" r="3" fill="#424242" /> <!-- Right eye -->
                            <path d="M95 40 Q100 45 105 40" stroke="#424242" stroke-width="2" fill="none" /> <!-- Smile -->
                        </svg>
                        <div class="arm">
                            <svg width="100" height="150" viewBox="0 0 100 150">
                                <!-- Arm -->
                                <rect x="10" y="10" width="40" height="130" rx="20" fill="#ffccbc" />
                                <!-- Vein -->
                                <path d="M25 40 L25 120" class="vein" />
                                <!-- Cleaned area indicator (initially hidden) -->
                                <circle id="cleaned-area" cx="25" cy="80" r="15" fill="rgba(200, 230, 255, 0.5)" style="display: none;" />
                                <!-- Bandage (initially hidden) -->
                                <rect id="bandage" x="10" y="70" width="40" height="20" rx="5" fill="#f5f5f5" stroke="#bdbdbd" stroke-width="1" style="display: none;" />
                            </svg>
                        </div>
                    </div>
                    
                    <div class="blood-sample" id="blood-sample">
                        <svg width="40" height="80" viewBox="0 0 40 80">
                            <!-- Test tube -->
                            <rect x="5" y="5" width="30" height="70" rx="5" fill="white" stroke="#bdbdbd" stroke-width="2" />
                            <!-- Blood -->
                            <rect x="5" y="30" width="30" height="45" rx="5" fill="#e53935" />
                            <!-- Tube cap -->
                            <rect x="5" y="2" width="30" height="8" rx="2" fill="#7b1fa2" />
                        </svg>
                    </div>
                    
                    <div class="test-result" id="test-result"></div>
                    
                    <div class="patient-target" id="patient-target">
                        <svg width="200" height="350" viewBox="0 0 200 350">
                            <!-- Patient body -->
                            <rect x="50" y="50" width="100" height="200" rx="20" fill="#f5cba7" />
                            <!-- Patient head -->
                            <circle cx="100" cy="30" r="30" fill="#f5cba7" />
                            <!-- Patient details -->
                            <circle cx="90" cy="25" r="3" fill="#424242" /> <!-- Left eye -->
                            <circle cx="110" cy="25" r="3" fill="#424242" /> <!-- Right eye -->
                            <path d="M95 45 Q100 40 105 45" stroke="#424242" stroke-width="2" fill="none" /> <!-- Frown (sick) -->
                        </svg>
                        <div class="arm">
                            <svg width="100" height="150" viewBox="0 0 100 150">
                                <!-- Arm -->
                                <rect x="10" y="10" width="40" height="130" rx="20" fill="#f5cba7" />
                                <!-- Vein -->
                                <path d="M25 40 L25 120" class="vein" />
                                <!-- IV insertion point (initially hidden) -->
                                <circle id="iv-point" cx="25" cy="80" r="5" fill="#e53935" style="display: none;" />
                            </svg>
                        </div>
                    </div>
                    
                    <div class="blood-bag" id="blood-bag" >
                        <svg width="80" height="100" viewBox="0 0 80 100">
                            <!-- Blood bag -->
                            <path d="M5 5 L45 5 L45 35 Q25 45 5 35 Z" fill="#e53935" stroke="#7b1fa2" stroke-width="2" />
                            <!-- Blood type label -->
                            <circle cx="25" cy="20" r="8" fill="white" stroke="#7b1fa2" stroke-width="1" />
                            <text id="blood-type-text" x="25" y="23" text-anchor="middle" font-weight="bold" font-size="8">A+</text>
                            <!-- Tube -->
                            <path d="M25 45 L25 50" stroke="white" stroke-width="2" />
                            <!-- Drip -->
                            <circle id="drip" cx="25" cy="52" r="1" fill="#e53935" style="display: none;" />
                        </svg>
                    </div>
                    
                    <!-- Laboratory scene -->
                    <div class="laboratory" id="laboratory">
                        <svg width="800" height="450" viewBox="0 0 800 450">
                            <!-- Lab equipment background -->
                            <rect x="50" y="50" width="700" height="300" rx="5" fill="#e0e0e0" stroke="#bdbdbd" stroke-width="2" />
                            
                            <!-- Blood sample in lab -->
                            <g transform="translate(150, 150)" id="lab-blood-sample">
                                <!-- Test tube -->
                                <rect x="-15" y="-40" width="30" height="70" rx="5" fill="white" stroke="#bdbdbd" stroke-width="2" />
                                <!-- Blood -->
                                <rect x="-15" y="-10" width="30" height="40" rx="5" fill="#e53935" />
                                <!-- Tube cap -->
                                <rect x="-15" y="-45" width="30" height="8" rx="2" fill="#7b1fa2" />
                            </g>
                            
                            <!-- Blood testing kit -->
                            <g transform="translate(350, 200)" id="test-plates">
                                <!-- A plate -->
                                <g class="test-plate" id="test-plate-a" data-type="A">
                                    <circle cx="-120" cy="0" r="30" fill="#f5f5f5" stroke="#bdbdbd" stroke-width="2" />
                                    <text x="-120" y="5" text-anchor="middle" font-size="16" font-weight="bold">A</text>
                                    <!-- Reagent (light yellow) -->
                                    <circle cx="-120" cy="0" r="25" fill="#fff9c4" fill-opacity="0.6" />
                                    <!-- Coagulation result (initially hidden) -->
                                    <g id="result-a" style="display: none;">
                                        <circle cx="-120" cy="0" r="15" fill="#e53935" fill-opacity="0.7" class="coagulation-positive" />
                                        <path d="M-130 -10 L-110 10 M-130 10 L-110 -10" stroke="#8d0000" stroke-width="2" />
                                    </g>
                                </g>
                                
                                <!-- B plate -->
                                <g class="test-plate" id="test-plate-b" data-type="B">
                                    <circle cx="0" cy="0" r="30" fill="#f5f5f5" stroke="#bdbdbd" stroke-width="2" />
                                    <text x="0" y="5" text-anchor="middle" font-size="16" font-weight="bold">B</text>
                                    <!-- Reagent (light blue) -->
                                    <circle cx="0" cy="0" r="25" fill="#bbdefb" fill-opacity="0.6" />
                                    <!-- Coagulation result (initially hidden) -->
                                    <g id="result-b" style="display: none;">
                                        <circle cx="0" cy="0" r="15" fill="#e53935" fill-opacity="0.7" class="coagulation-positive" />
                                        <path d="M-10 -10 L10 10 M-10 10 L10 -10" stroke="#8d0000" stroke-width="2" />
                                    </g>
                                </g>
                                
                                <!-- Rh plate -->
                                <g class="test-plate" id="test-plate-rh" data-type="Rh">
                                    <circle cx="120" cy="0" r="30" fill="#f5f5f5" stroke="#bdbdbd" stroke-width="2" />
                                    <text x="120" y="5" text-anchor="middle" font-size="16" font-weight="bold">Rh</text>
                                    <!-- Reagent (light green) -->
                                    <circle cx="120" cy="0" r="25" fill="#c8e6c9" fill-opacity="0.6" />
                                    <!-- Coagulation result (initially hidden) -->
                                    <g id="result-rh" style="display: none;">
                                        <circle cx="120" cy="0" r="15" fill="#e53935" fill-opacity="0.7" class="coagulation-positive" />
                                        <path d="M110 -10 L130 10 M110 10 L130 -10" stroke="#8d0000" stroke-width="2" />
                                    </g>
                                </g>
                            </g>
                        </svg>
                    </div>
                    
                    <!-- Transfusion room scene -->
                    <div class="transfusion-room" id="transfusion-room">
                        <svg width="800" height="450" viewBox="0 0 800 450">
                            <!-- Background wall elements -->
                            <rect x="0" y="0" width="800" height="450" fill="#e8f5e9" />
                            
                            <!-- Hospital bed - shifted left -->
                            <g class="hospital-bed" transform="translate(150, 230)">
                                <!-- Bed frame -->
                                <rect x="0" y="100" width="300" height="20" rx="5" fill="#42a5f5" stroke="#1976d2" stroke-width="2" />
                                <!-- Mattress -->
                                <rect x="0" y="80" width="290" height="20" rx="5" fill="white" stroke="#bdbdbd" stroke-width="1" />
                                <!-- Pillow -->
                                <rect x="0" y="75" width="60" height="15" rx="5" fill="#e0e0e0" stroke="#bdbdbd" stroke-width="1" />
                                <!-- Legs -->
                                <rect x="20" y="120" width="10" height="30" fill="#1976d2" />
                                <rect x="270" y="120" width="10" height="30" fill="#1976d2" />
                                
                                <!-- Patient in bed -->
                                <g class="patient-in-bed">
                                    <rect x="30" y="50" width="240" height="40" rx="10" fill="#f5cba7" /> <!-- Body -->
                                    <circle cx="50" cy="40" r="20" fill="#f5cba7" /> <!-- Head -->
                                    <circle cx="43" cy="35" r="3" fill="#424242" /> <!-- Left eye -->
                                    <circle cx="57" cy="35" r="3" fill="#424242" /> <!-- Right eye -->
                                    <path d="M43 45 Q50 42 57 45" stroke="#424242" stroke-width="2" fill="none" /> <!-- Slight smile -->
                                    <rect x="30" y="90" width="240" height="20" rx="10" fill="#e0e0e0" /> <!-- Blanket -->
                                </g>
                                
                                <!-- Patient arm -->
                                <rect x="80" y="30" width="20" height="60" rx="10" fill="#f5cba7" />
                                <path d="M90 50 L90 90" stroke="#5c6bc0" stroke-width="2" stroke-opacity="0.7" /> <!-- Vein -->
                                <circle id="transfusion-point" cx="90" cy="70" r="5" fill="#e53935" /> <!-- Transfusion point -->
                            </g>
    
                            <!-- IV Stand - repositioned to match the image -->
                            <g class="transfusion-stand" id="transfusion-stand" transform="translate(520, 100)">
                                <!-- Stand pole -->
                                <rect x="0" y="30" width="10" height="200" fill="#757575" stroke="#424242" stroke-width="1" />
                                <!-- Stand base -->
                                <path d="M-30 230 L40 230 L25 250 L-15 250 Z" fill="#757575" stroke="#424242" stroke-width="1" />
                                <!-- Hook - pemindahan posisi hook agar sesuai dengan gambar -->
                                <path d="M10 30 L30 30 L30 50" fill="none" stroke="#757575" stroke-width="3" />
                                
                                <!-- Drop zone - repositioned to match the image -->
                                <rect id="drop-zone" x="20" y="35" width="35" height="50" stroke="#e53935" 
                                    stroke-width="3" stroke-dasharray="5" fill="rgba(255,235,238,0.3)" 
                                    rx="5" class="drop-zone-highlight" />
                                
                                <!-- Instruction text -->
                                <text id="instruction-text" x="45" y="65" text-anchor="middle" font-size="10" fill="#d32f2f" 
                                    transform="rotate(-90, 45, 65)">Pasang di sini</text>
                            </g>
                            
                            <!-- Medical equipment - adds realism -->
                            <rect x="650" y="150" width="80" height="40" rx="5" fill="#e0e0e0" stroke="#bdbdbd" />
                            <circle cx="670" cy="170" r="5" fill="#4caf50" />
                            <rect x="680" y="165" width="40" height="10" rx="2" fill="#f5f5f5" />
                        </svg>
                    </div>
    
                    <!-- Transition overlay -->
                    <div class="transition-overlay" id="transition-overlay">
                        <div class="stage-title" id="stage-title">Stage Title</div>
                        <div class="stage-desc" id="stage-desc">Stage description goes here with important information about this stage.</div>
                    </div>
                </div>
            </div>
            
            <div class="controls" id="controls">
                <!-- Isi Item keperluan alat donor darah, item akan di panggil dari script -->
            </div>
            
            <!-- New placement: Blood type selection interface OUTSIDE scene but BEFORE message -->
            <div id="blood-type-selection-container" class="bg-white rounded-lg shadow-md p-4 mb-4 hidden transition-all duration-300">
              <!-- Petunjuk akan ditambahkan secara dinamis via JavaScript -->
              
                <h3 class="text-lg font-bold text-center text-gray-800 mb-3">Determine blood type:</h3>
              
              <!-- Tombol Golongan Darah dengan Warna yang Lebih Menarik -->
              <div class="flex justify-center space-x-3 mb-4">
                <button id="btn-a" class="blood-type-btn w-16 h-12 border-2 border-gray-300 rounded-md hover:bg-red-50 hover:border-red-500 focus:outline-none transition-all duration-200 font-bold text-lg text-red-800">A</button>
                <button id="btn-b" class="blood-type-btn w-16 h-12 border-2 border-gray-300 rounded-md hover:bg-red-50 hover:border-red-500 focus:outline-none transition-all duration-200 font-bold text-lg text-red-800">B</button>
                <button id="btn-ab" class="blood-type-btn w-16 h-12 border-2 border-gray-300 rounded-md hover:bg-red-50 hover:border-red-500 focus:outline-none transition-all duration-200 font-bold text-lg text-red-800">AB</button>
                <button id="btn-o" class="blood-type-btn w-16 h-12 border-2 border-gray-300 rounded-md hover:bg-red-50 hover:border-red-500 focus:outline-none transition-all duration-200 font-bold text-lg text-red-800">O</button>
              </div>
              
              <!-- Tombol Rhesus -->
              <h3 class="text-lg font-bold text-center text-gray-800 mb-3">Determmine Rhesus:</h3>
              <div class="flex justify-center space-x-3 mb-4">
                <button id="btn-rh-pos" class="rh-btn w-16 h-12 border-2 border-gray-300 rounded-md hover:bg-red-50 hover:border-red-500 focus:outline-none transition-all duration-200 font-bold text-lg text-red-800">Rh+</button>
                <button id="btn-rh-neg" class="rh-btn w-16 h-12 border-2 border-gray-300 rounded-md hover:bg-red-50 hover:border-red-500 focus:outline-none transition-all duration-200 font-bold text-lg text-red-800">Rh-</button>
              </div>
              
              <!-- Tombol Konfirmasi dengan Efek Hover -->
              <div id="confirm-selection" class="flex justify-center hidden">
                <button id="btn-confirm" class="w-40 h-12 bg-red-600 text-white font-bold rounded-md hover:bg-red-700 focus:outline-none transform hover:scale-105 transition-all duration-200 flex items-center justify-center">
                  <span>Konfirmasi</span>
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                  </svg>
                </button>
              </div>
            </div>
            
            <!-- Tampilan Hasil Tes dengan Efek Transisi -->
            <div id="test-result-display" class="bg-white rounded-lg shadow-md p-5 mb-4 hidden transition-all duration-500 transform">
              <h3 id="result-text" class="text-xl font-bold text-center text-gray-800 mb-2">Blood Type: ?</h3>
              <div class="flex justify-center">
                <div class="w-20 h-20 bg-red-100 rounded-full flex items-center justify-center">
                  <span id="result-blood-type" class="text-3xl font-bold text-red-600">?</span>
                </div>
              </div>
              <p class="text-center text-gray-600 mt-3">Blood type successfully identified</p>
            </div>
    
            <div class="message" id="message">Choose a tool to start blood donation</div>
    
            <button class="btn" id="next-btn" disabled>Next</button>
    
            <div class="alert" id="alert">Alert message</div>
        </div>

        <div id="quiz" class="hidden p-6">
            <!-- Quiz intro screen -->
            <div id="quiz-intro" class="text-center py-8">
              <h3 class="text-2xl font-bold text-gray-800 mb-4">Blood Donation Quiz</h3>
              <p class="text-gray-600 mb-6">Test your knowledge about blood donation with this interactive quiz!</p>
              <p class="text-gray-600 mb-8">Answer all questions correctly to earn points!</p>
              <button
                id="start-quiz"
                class="bg-red-600 text-white py-3 px-8 rounded-lg hover:bg-red-700 transition duration-300"
              >
                Start Quiz
              </button>
            </div>

            <!-- Quiz container -->
            <div id="quiz-container" class="hidden">
              <!-- Progress bar -->
              <div class="flex items-center justify-between mb-2">
                <span class="text-sm text-gray-600"
                  >Question <span id="current-question">1</span> of <span id="total-questions">3</span></span
                >
                <span class="text-sm text-gray-600">Score: <span id="quiz-score">0</span></span>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-2.5 mb-6">
                <div id="quiz-progress" class="bg-red-600 h-2.5 rounded-full" style="width: 33%"></div>
              </div>

              <!-- Question container -->
              <div id="question-container">
                <h3 id="question-text" class="text-xl font-bold text-gray-800 mb-6">
                  How long does it take for the body to replace plasma after donating blood?
                </h3>
                <div id="options-container" class="space-y-3 mb-6">
                  <!-- Options will be inserted here by JavaScript -->
                </div>
                <div class="flex justify-between">
                  <button
                    id="next-question"
                    class="bg-red-600 text-white py-2 px-6 rounded-lg hover:bg-red-700 transition duration-300 hidden"
                  >
                    Next Question
                  </button>
                  <button
                    id="submit-answer"
                    class="bg-red-600 text-white py-2 px-6 rounded-lg hover:bg-red-700 transition duration-300"
                  >
                    Submit Answer
                  </button>
                </div>
              </div>
            </div>

            <!-- Results screen -->
            <div id="quiz-results" class="hidden text-center py-8">
              <div id="success-icon" class="mx-auto mb-6 text-green-500">
                <i class="fas fa-trophy text-6xl"></i>
              </div>
              <h3 class="text-2xl font-bold text-gray-800 mb-4">Quiz Complete!</h3>
              <p class="text-xl mb-2">Your score: <span id="final-score">0</span> / 3</p>
              <p id="result-message" class="text-gray-600 mb-6">Well done!</p>
              <p class="text-green-600 mb-8 text-lg font-bold hidden" id="points-earned">
                +<span id="points-value">30</span> points earned!
              </p>
              <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-4">
                <button
                  id="retry-quiz"
                  class="bg-red-600 text-white py-2 px-6 rounded-lg hover:bg-red-700 transition duration-300"
                >
                  Try Again
                </button>
                <button
                  id="back-to-home"
                  class="bg-gray-600 text-white py-2 px-6 rounded-lg hover:bg-gray-700 transition duration-300"
                >
                  Back to Home
                </button>
              </div>
            </div>

            <!-- Feedback alert -->
            <div id="feedback-alert" class="hidden mt-4 p-4 rounded-lg">
              <p id="feedback-text" class="font-medium"></p>
              <p id="feedback-explanation" class="text-sm mt-2"></p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="py-16 px-4 bg-white" id="leaderboard">
      <div class="container mx-auto">
        <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Leaderboard</h2>

        <div class="grid md:grid-cols-2 gap-8">
          <div class="bg-white rounded-xl shadow-lg overflow-hidden">
            <h3 class="bg-red-600 text-white text-xl font-bold py-4 px-6">Blood Donation Simulation</h3>
            <ul class="divide-y divide-gray-200">
              <li class="flex items-center p-4">
                <div class="bg-red-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-4">
                  1
                </div>
                <div class="flex items-center flex-grow">
                  <div class="bg-gray-200 rounded-full w-8 h-8 flex items-center justify-center mr-3">R</div>
                  <span class="font-medium">Rizky_88</span>
                </div>
                <div class="font-bold">950</div>
              </li>
              <li class="flex items-center p-4">
                <div
                  class="bg-gray-400 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-4"
                >
                  2
                </div>
                <div class="flex items-center flex-grow">
                  <div class="bg-gray-200 rounded-full w-8 h-8 flex items-center justify-center mr-3">A</div>
                  <span class="font-medium">Andi123</span>
                </div>
                <div class="font-bold">820</div>
              </li>
              <li class="flex items-center p-4">
                <div
                  class="bg-yellow-700 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-4"
                >
                  3
                </div>
                <div class="flex items-center flex-grow">
                  <div class="bg-gray-200 rounded-full w-8 h-8 flex items-center justify-center mr-3">F</div>
                  <span class="font-medium">Fitri_PMI</span>
                </div>
                <div class="font-bold">790</div>
              </li>
              <li class="flex items-center p-4">
                <div class="text-gray-600 rounded-full w-8 h-8 flex items-center justify-center font-bold mr-4">4</div>
                <div class="flex items-center flex-grow">
                  <div class="bg-gray-200 rounded-full w-8 h-8 flex items-center justify-center mr-3">S</div>
                  <span class="font-medium">SandiW</span>
                </div>
                <div class="font-bold">715</div>
              </li>
              <li class="flex items-center p-4">
                <div class="text-gray-600 rounded-full w-8 h-8 flex items-center justify-center font-bold mr-4">5</div>
                <div class="flex items-center flex-grow">
                  <div class="bg-gray-200 rounded-full w-8 h-8 flex items-center justify-center mr-3">D</div>
                  <span class="font-medium">DewiAnggraini</span>
                </div>
                <div class="font-bold">690</div>
              </li>
            </ul>
          </div>

          <div class="bg-white rounded-xl shadow-lg overflow-hidden">
            <h3 class="bg-red-600 text-white text-xl font-bold py-4 px-6">Blood Donation Quiz</h3>
            <ul class="divide-y divide-gray-200">
              <li class="flex items-center p-4">
                <div class="bg-red-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-4">
                  1
                </div>
                <div class="flex items-center flex-grow">
                  <div class="bg-gray-200 rounded-full w-8 h-8 flex items-center justify-center mr-3">B</div>
                  <span class="font-medium">Budi_Smart</span>
                </div>
                <div class="font-bold">850</div>
              </li>
              <li class="flex items-center p-4">
                <div
                  class="bg-gray-400 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-4"
                >
                  2
                </div>
                <div class="flex items-center flex-grow">
                  <div class="bg-gray-200 rounded-full w-8 h-8 flex items-center justify-center mr-3">S</div>
                  <span class="font-medium">Sinta22</span>
                </div>
                <div class="font-bold">810</div>
              </li>
              <li class="flex items-center p-4">
                <div
                  class="bg-yellow-700 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-4"
                >
                  3
                </div>
                <div class="flex items-center flex-grow">
                  <div class="bg-gray-200 rounded-full w-8 h-8 flex items-center justify-center mr-3">M</div>
                  <span class="font-medium">Maya_SMA</span>
                </div>
                <div class="font-bold">780</div>
              </li>
              <li class="flex items-center p-4">
                <div class="text-gray-600 rounded-full w-8 h-8 flex items-center justify-center font-bold mr-4">4</div>
                <div class="flex items-center flex-grow">
                  <div class="bg-gray-200 rounded-full w-8 h-8 flex items-center justify-center mr-3">R</div>
                  <span class="font-medium">Rudi_PMI</span>
                </div>
                <div class="font-bold">760</div>
              </li>
              <li class="flex items-center p-4">
                <div class="text-gray-600 rounded-full w-8 h-8 flex items-center justify-center font-bold mr-4">5</div>
                <div class="flex items-center flex-grow">
                  <div class="bg-gray-200 rounded-full w-8 h-8 flex items-center justify-center mr-3">D</div>
                  <span class="font-medium">Dinda09</span>
                </div>
                <div class="font-bold">705</div>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <section class="py-16 px-4 bg-white" id="education">
      <div class="container mx-auto">
        <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Blood Donation Education</h2>

        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
          <div class="flex flex-wrap border-b">
            <button
              class="education-tab py-3 px-4 font-medium text-gray-800 bg-gray-200 hover:bg-gray-300 transition duration-300 focus:outline-none text-sm md:text-base"
              data-tab="human-body"
            >
              Human Body
            </button>
            <button
              class="education-tab py-3 px-4 font-medium text-gray-800 hover:bg-gray-200 transition duration-300 focus:outline-none text-sm md:text-base"
              data-tab="blood-products"
            >
              Blood Products
            </button>
            <button
              class="education-tab py-3 px-4 font-medium text-gray-800 hover:bg-gray-200 transition duration-300 focus:outline-none text-sm md:text-base"
              data-tab="blood-needs"
            >
              Blood Needs
            </button>
            <button
              class="education-tab py-3 px-4 font-medium text-gray-800 hover:bg-gray-200 transition duration-300 focus:outline-none text-sm md:text-base"
              data-tab="storage"
            >
              Storage
            </button>
            <button
              class="education-tab py-3 px-4 font-medium text-gray-800 hover:bg-gray-200 transition duration-300 focus:outline-none text-sm md:text-base"
              data-tab="processing"
            >
              Processing
            </button>
            <button
              class="education-tab py-3 px-4 font-medium text-gray-800 hover:bg-gray-200 transition duration-300 focus:outline-none text-sm md:text-base"
              data-tab="donation-process"
            >
              Donation Process
            </button>
          </div>

          <!-- Human Body Tab -->
          <div class="education-content p-6" id="human-body-content">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">Understanding the Human Body</h3>

            <h4 class="text-xl font-bold text-gray-700 mb-2">The Circulatory System</h4>
            <div class="flex flex-col md:flex-row gap-6 mb-8">
              <div class="md:w-2/3">
                <p class="text-gray-600 mb-4">
                  The circulatory system is the body's transportation network, responsible for delivering oxygen,
                  nutrients, hormones, and immune cells to tissues while removing waste products.
                </p>
                <p class="text-gray-600 mb-4">
                  At the center of this system is the heart, a powerful muscle that pumps blood throughout the body. The
                  average adult has about 5-6 liters of blood circulating in their body.
                </p>
              </div>
              <div class="md:w-1/3">
                <img
                  src="img/human-circulatory.png"
                  alt="Circulatory System"
                  class="w-full h-auto rounded-lg shadow-md"
                />
              </div>
            </div>

            <h4 class="text-xl font-bold text-gray-700 mb-2">Blood: The River of Life</h4>
            <p class="text-gray-600 mb-4">
              Blood is a specialized body fluid that consists of cells suspended in a liquid called plasma. It makes up
              approximately 7-8% of human body weight.
            </p>

            <div class="flex flex-col md:flex-row gap-6 mb-8">
              <div class="md:w-1/2 bg-gray-50 p-4 rounded-lg shadow-sm">
                <h5 class="font-bold text-gray-700 mb-2">Primary Functions of Blood:</h5>
                <ul class="list-disc list-inside text-gray-600 space-y-2">
                  <li>Transportation of oxygen from the lungs to all body tissues</li>
                  <li>Delivery of nutrients from the digestive system to cells</li>
                  <li>Removal of waste products to excretory organs</li>
                  <li>Defense against infections through white blood cells</li>
                  <li>Regulation of body temperature</li>
                  <li>Maintenance of proper pH balance</li>
                  <li>Prevention of blood loss through clotting</li>
                </ul>
              </div>
              <div class="md:w-1/2 bg-gray-50 p-4 rounded-lg shadow-sm">
                <h5 class="font-bold text-gray-700 mb-2">Blood Composition:</h5>
                <div class="relative h-40">
                  <div class="absolute inset-0 rounded-lg overflow-hidden">
                    <div class="h-2/5 bg-yellow-100 w-full p-2 flex items-center">
                      <span class="text-sm font-medium">Plasma (55%)</span>
                    </div>
                    <div class="h-2/5 bg-red-400 w-full p-2 flex items-center">
                      <span class="text-sm font-medium text-white">Red Blood Cells (45%)</span>
                    </div>
                    <div class="h-1/5 flex w-full">
                      <div class="h-full bg-blue-300 w-4/5 p-1 flex items-center justify-center">
                        <span class="text-xs font-medium">White Blood Cells</span>
                      </div>
                      <div class="h-full bg-purple-300 w-1/5 p-1 flex items-center justify-center">
                        <span class="text-xs font-medium">Platelets</span>
                      </div>
                    </div>
                  </div>
                </div>
                <p class="text-xs text-gray-500 mt-2 text-center">Visual representation of blood composition</p>
              </div>
            </div>

            <div class="bg-red-50 border-l-4 border-red-500 p-4 mb-6">
              <h5 class="font-bold text-red-700 mb-1">Did You Know?</h5>
              <p class="text-gray-700">
                The average adult has around 5-6 liters of blood in their body, which is replenished constantly. When
                you donate blood (450ml), your body replaces the fluid portion within 24 hours and the cellular
                components within a few weeks.
              </p>
            </div>
          </div>

          <!-- Blood Products Tab -->
          <div class="education-content p-6 hidden" id="blood-products-content">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">Types of Blood Products</h3>

            <h4 class="text-xl font-bold text-gray-700 mb-2">Blood Types and Compatibility</h4>
            <p class="text-gray-600 mb-4">
              Blood types are determined by the presence or absence of certain antigens on the surface of red blood
              cells. The two main classification systems are ABO and Rh factor.
            </p>

            <div class="overflow-x-auto mb-8">
              <table class="min-w-full bg-white rounded-lg overflow-hidden">
                <thead class="bg-red-600 text-white">
                  <tr>
                    <th class="py-3 px-4 text-left">Blood Type</th>
                    <th class="py-3 px-4 text-left">Can Donate To</th>
                    <th class="py-3 px-4 text-left">Can Receive From</th>
                    <th class="py-3 px-4 text-left">Population %</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                  <tr class="hover:bg-gray-50">
                    <td class="py-3 px-4 font-medium">A+</td>
                    <td class="py-3 px-4">A+, AB+</td>
                    <td class="py-3 px-4">A+, A-, O+, O-</td>
                    <td class="py-3 px-4">~30%</td>
                  </tr>
                  <tr class="hover:bg-gray-50">
                    <td class="py-3 px-4 font-medium">A-</td>
                    <td class="py-3 px-4">A+, A-, AB+, AB-</td>
                    <td class="py-3 px-4">A-, O-</td>
                    <td class="py-3 px-4">~6%</td>
                  </tr>
                  <tr class="hover:bg-gray-50">
                    <td class="py-3 px-4 font-medium">B+</td>
                    <td class="py-3 px-4">B+, AB+</td>
                    <td class="py-3 px-4">B+, B-, O+, O-</td>
                    <td class="py-3 px-4">~8%</td>
                  </tr>
                  <tr class="hover:bg-gray-50">
                    <td class="py-3 px-4 font-medium">B-</td>
                    <td class="py-3 px-4">B+, B-, AB+, AB-</td>
                    <td class="py-3 px-4">B-, O-</td>
                    <td class="py-3 px-4">~2%</td>
                  </tr>
                  <tr class="hover:bg-gray-50">
                    <td class="py-3 px-4 font-medium">AB+</td>
                    <td class="py-3 px-4">AB+ (Universal recipient)</td>
                    <td class="py-3 px-4">All types</td>
                    <td class="py-3 px-4">~3%</td>
                  </tr>
                  <tr class="hover:bg-gray-50">
                    <td class="py-3 px-4 font-medium">AB-</td>
                    <td class="py-3 px-4">AB+, AB-</td>
                    <td class="py-3 px-4">A-, B-, AB-, O-</td>
                    <td class="py-3 px-4">~1%</td>
                  </tr>
                  <tr class="hover:bg-gray-50">
                    <td class="py-3 px-4 font-medium">O+</td>
                    <td class="py-3 px-4">A+, B+, AB+, O+</td>
                    <td class="py-3 px-4">O+, O-</td>
                    <td class="py-3 px-4">~38%</td>
                  </tr>
                  <tr class="hover:bg-gray-50">
                    <td class="py-3 px-4 font-medium">O-</td>
                    <td class="py-3 px-4">All types (Universal donor)</td>
                    <td class="py-3 px-4">O- only</td>
                    <td class="py-3 px-4">~7%</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <h4 class="text-xl font-bold text-gray-700 mb-2">Blood Components and Their Uses</h4>

            <div class="grid md:grid-cols-2 gap-6 mb-8">
              <div class="bg-white rounded-lg shadow-md overflow-hidden border border-gray-200">
                <div class="bg-red-600 text-white p-3">
                  <h5 class="font-bold">Red Blood Cells (Erythrocytes)</h5>
                </div>
                <div class="p-4">
                  <p class="text-gray-600 mb-3">
                    Disc-shaped cells containing hemoglobin that transport oxygen throughout the body.
                  </p>
                  <h6 class="font-bold text-gray-700 mb-1">Used for:</h6>
                  <ul class="list-disc list-inside text-gray-600 mb-3">
                    <li>Severe anemia</li>
                    <li>Blood loss from surgery or injury</li>
                    <li>Chronic conditions like thalassemia</li>
                  </ul>
                  <h6 class="font-bold text-gray-700 mb-1">Storage Time:</h6>
                  <p class="text-gray-600">Up to 42 days at 2-6°C</p>
                </div>
              </div>

              <div class="bg-white rounded-lg shadow-md overflow-hidden border border-gray-200">
                <div class="bg-yellow-400 text-white p-3">
                  <h5 class="font-bold">Blood Plasma</h5>
                </div>
                <div class="p-4">
                  <p class="text-gray-600 mb-3">
                    Yellowish liquid component of blood that contains proteins, clotting factors, and other substances.
                  </p>
                  <h6 class="font-bold text-gray-700 mb-1">Used for:</h6>
                  <ul class="list-disc list-inside text-gray-600 mb-3">
                    <li>Bleeding disorders</li>
                    <li>Burns and shock</li>
                    <li>Liver diseases</li>
                    <li>Immunodeficiencies</li>
                  </ul>
                  <h6 class="font-bold text-gray-700 mb-1">Storage Time:</h6>
                  <p class="text-gray-600">Up to 1 year frozen at -18°C or below</p>
                </div>
              </div>

              <div class="bg-white rounded-lg shadow-md overflow-hidden border border-gray-200">
                <div class="bg-purple-500 text-white p-3">
                  <h5 class="font-bold">Platelets (Thrombocytes)</h5>
                </div>
                <div class="p-4">
                  <p class="text-gray-600 mb-3">
                    Tiny cell fragments that help blood to clot and prevent excessive bleeding.
                  </p>
                  <h6 class="font-bold text-gray-700 mb-1">Used for:</h6>
                  <ul class="list-disc list-inside text-gray-600 mb-3">
                    <li>Cancer patients undergoing chemotherapy</li>
                    <li>Bone marrow transplant recipients</li>
                    <li>Bleeding disorders</li>
                    <li>Major surgeries or trauma</li>
                  </ul>
                  <h6 class="font-bold text-gray-700 mb-1">Storage Time:</h6>
                  <p class="text-gray-600">Up to 5 days at room temperature with agitation</p>
                </div>
              </div>

              <div class="bg-white rounded-lg shadow-md overflow-hidden border border-gray-200">
                <div class="bg-blue-500 text-white p-3">
                  <h5 class="font-bold">Cryoprecipitate</h5>
                </div>
                <div class="p-4">
                  <p class="text-gray-600 mb-3">
                    Concentrated portion of plasma containing clotting factors like fibrinogen, Factor VIII, and von
                    Willebrand factor.
                  </p>
                  <h6 class="font-bold text-gray-700 mb-1">Used for:</h6>
                  <ul class="list-disc list-inside text-gray-600 mb-3">
                    <li>Hemophilia</li>
                    <li>Von Willebrand disease</li>
                    <li>Disseminated intravascular coagulation (DIC)</li>
                    <li>Massive bleeding with low fibrinogen</li>
                  </ul>
                  <h6 class="font-bold text-gray-700 mb-1">Storage Time:</h6>
                  <p class="text-gray-600">Up to 1 year frozen at -18°C or below</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Blood Needs Tab -->
          <div class="education-content p-6 hidden" id="blood-needs-content">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">Blood Needs and Demand</h3>

            <div class="flex flex-col md:flex-row gap-8 mb-8">
              <div class="md:w-1/2">
                <h4 class="text-xl font-bold text-gray-700 mb-4">Why Is Blood Always Needed?</h4>
                <p class="text-gray-600 mb-4">
                  Blood cannot be manufactured or synthesized — it can only come from generous donors. Even with medical
                  advances, there is no substitute for human blood.
                </p>
                <p class="text-gray-600 mb-4">
                  Every day, hospitals need fresh supplies of blood for routine surgeries, emergency situations, and
                  ongoing treatments for chronic conditions.
                </p>
                <div class="bg-red-50 border-l-4 border-red-500 p-4 mb-6">
                  <p class="text-gray-700 font-medium">
                    Every 2 seconds, someone needs blood — that's approximately 43,000 units needed daily.
                  </p>
                </div>
              </div>
              <div class="md:w-1/2">
                <img
                  src="img/blood-donation.png"
                  alt="Blood Donation Need"
                  class="w-full h-auto rounded-lg shadow-md"
                />
              </div>
            </div>

            <h4 class="text-xl font-bold text-gray-700 mb-4">Who Needs Blood?</h4>

            <div class="grid md:grid-cols-3 gap-6 mb-8">
              <div class="bg-white rounded-lg shadow-md p-5 border-t-4 border-red-600">
                <div class="text-red-600 mb-3">
                  <i class="fas fa-hospital-user text-3xl"></i>
                </div>
                <h5 class="font-bold text-gray-800 mb-2">Surgery and Trauma Patients</h5>
                <p class="text-gray-600">
                  Patients undergoing major surgeries or experiencing traumatic injuries often require blood
                  transfusions to replace lost blood and stabilize their condition.
                </p>
              </div>

              <div class="bg-white rounded-lg shadow-md p-5 border-t-4 border-red-600">
                <div class="text-red-600 mb-3">
                  <i class="fas fa-baby text-3xl"></i>
                </div>
                <h5 class="font-bold text-gray-800 mb-2">Mothers and Newborns</h5>
                <p class="text-gray-600">
                  Women experiencing complications during childbirth may need blood transfusions. Premature and ill
                  newborns often need blood components.
                </p>
              </div>

              <div class="bg-white rounded-lg shadow-md p-5 border-t-4 border-red-600">
                <div class="text-red-600 mb-3">
                  <i class="fas fa-heartbeat text-3xl"></i>
                </div>
                <h5 class="font-bold text-gray-800 mb-2">Cancer Patients</h5>
                <p class="text-gray-600">
                  Many cancer treatments affect the body's ability to produce blood cells. Transfusions help patients
                  maintain strength during chemotherapy and radiation.
                </p>
              </div>

              <div class="bg-white rounded-lg shadow-md p-5 border-t-4 border-red-600">
                <div class="text-red-600 mb-3">
                  <i class="fas fa-procedures text-3xl"></i>
                </div>
                <h5 class="font-bold text-gray-800 mb-2">Chronic Disease Patients</h5>
                <p class="text-gray-600">
                  People with sickle cell disease, thalassemia, and hemophilia require regular blood transfusions
                  throughout their lives.
                </p>
              </div>

              <div class="bg-white rounded-lg shadow-md p-5 border-t-4 border-red-600">
                <div class="text-red-600 mb-3">
                  <i class="fas fa-car-crash text-3xl"></i>
                </div>
                <h5 class="font-bold text-gray-800 mb-2">Accident Victims</h5>
                <p class="text-gray-600">
                  A single car accident victim can require up to 100 units of blood. Emergency responders need immediate
                  access to blood to save lives.
                </p>
              </div>

              <div class="bg-white rounded-lg shadow-md p-5 border-t-4 border-red-600">
                <div class="text-red-600 mb-3">
                  <i class="fas fa-fire text-3xl"></i>
                </div>
                <h5 class="font-bold text-gray-800 mb-2">Burn Victims</h5>
                <p class="text-gray-600">
                  People with severe burns often need plasma transfusions to replace lost fluids and help maintain blood
                  pressure.
                </p>
              </div>
            </div>

            <h4 class="text-xl font-bold text-gray-700 mb-4">Blood Usage Statistics</h4>

            <div class="bg-white rounded-lg shadow-md overflow-hidden mb-8">
              <div class="p-6">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                  <div class="bg-gray-50 p-4 rounded-lg text-center">
                    <span class="block text-3xl font-bold text-red-600 mb-2">36,000</span>
                    <span class="text-sm text-gray-600">Units of red blood cells needed daily</span>
                  </div>
                  <div class="bg-gray-50 p-4 rounded-lg text-center">
                    <span class="block text-3xl font-bold text-red-600 mb-2">7,000</span>
                    <span class="text-sm text-gray-600">Units of platelets needed daily</span>
                  </div>
                  <div class="bg-gray-50 p-4 rounded-lg text-center">
                    <span class="block text-3xl font-bold text-red-600 mb-2">10,000</span>
                    <span class="text-sm text-gray-600">Units of plasma needed daily</span>
                  </div>
                  <div class="bg-gray-50 p-4 rounded-lg text-center">
                    <span class="block text-3xl font-bold text-red-600 mb-2">3</span>
                    <span class="text-sm text-gray-600">Lives saved by one donation</span>
                  </div>
                </div>

                <h5 class="font-bold text-gray-700 mb-2">Blood Usage by Condition:</h5>
                <div class="space-y-3">
                  <div>
                    <div class="flex justify-between mb-1">
                      <span class="text-sm font-medium text-gray-700">Cancer Treatment</span>
                      <span class="text-sm font-medium text-gray-700">25%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                      <div class="bg-red-600 h-2 rounded-full" style="width: 25%"></div>
                    </div>
                  </div>
                  <div>
                    <div class="flex justify-between mb-1">
                      <span class="text-sm font-medium text-gray-700">Surgery & Trauma</span>
                      <span class="text-sm font-medium text-gray-700">35%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                      <div class="bg-red-600 h-2 rounded-full" style="width: 35%"></div>
                    </div>
                  </div>
                  <div>
                    <div class="flex justify-between mb-1">
                      <span class="text-sm font-medium text-gray-700">Blood Disorders</span>
                      <span class="text-sm font-medium text-gray-700">15%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                      <div class="bg-red-600 h-2 rounded-full" style="width: 15%"></div>
                    </div>
                  </div>
                  <div>
                    <div class="flex justify-between mb-1">
                      <span class="text-sm font-medium text-gray-700">Heart & Burn Procedures</span>
                      <span class="text-sm font-medium text-gray-700">12%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                      <div class="bg-red-600 h-2 rounded-full" style="width: 12%"></div>
                    </div>
                  </div>
                  <div>
                    <div class="flex justify-between mb-1">
                      <span class="text-sm font-medium text-gray-700">Other Medical Conditions</span>
                      <span class="text-sm font-medium text-gray-700">13%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                      <div class="bg-red-600 h-2 rounded-full" style="width: 13%"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Insert this section after the education section and before the footer -->
<!-- Blood Availability Section -->
<section class="py-10 px-4 bg-red-50" id="blood-stock">
  <div class="container mx-auto">
    <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Blood Stock Availability</h2>
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
      <!-- Blood Type A+ -->
      <div class="bg-white rounded-xl shadow-md p-4 flex flex-col items-center">
        <div class="w-16 h-16 rounded-full bg-red-100 flex items-center justify-center mb-2">
          <span class="text-red-600 text-2xl font-bold">A+</span>
        </div>
        <span class="text-lg font-semibold">85 Units</span>
        <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
          <div class="bg-red-600 h-2.5 rounded-full" style="width: 85%"></div>
        </div>
        <span class="text-sm text-gray-500 mt-2">Status: Available</span>
      </div>
      <!-- Blood Type B+ -->
      <div class="bg-white rounded-xl shadow-md p-4 flex flex-col items-center">
        <div class="w-16 h-16 rounded-full bg-red-100 flex items-center justify-center mb-2">
          <span class="text-red-600 text-2xl font-bold">B+</span>
        </div>
        <span class="text-lg font-semibold">43 Units</span>
        <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
          <div class="bg-yellow-500 h-2.5 rounded-full" style="width: 43%"></div>
        </div>
        <span class="text-sm text-yellow-500 mt-2">Status: Low</span>
      </div>
      <!-- Blood Type AB+ -->
      <div class="bg-white rounded-xl shadow-md p-4 flex flex-col items-center">
        <div class="w-16 h-16 rounded-full bg-red-100 flex items-center justify-center mb-2">
          <span class="text-red-600 text-2xl font-bold">AB+</span>
        </div>
        <span class="text-lg font-semibold">25 Units</span>
        <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
          <div class="bg-red-500 h-2.5 rounded-full" style="width: 25%"></div>
        </div>
        <span class="text-sm text-red-500 mt-2">Status: Critical</span>
      </div>
      <!-- Blood Type O+ -->
      <div class="bg-white rounded-xl shadow-md p-4 flex flex-col items-center">
        <div class="w-16 h-16 rounded-full bg-red-100 flex items-center justify-center mb-2">
          <span class="text-red-600 text-2xl font-bold">O+</span>
        </div>
        <span class="text-lg font-semibold">60 Units</span>
        <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
          <div class="bg-yellow-500 h-2.5 rounded-full" style="width: 60%"></div>
        </div>
        <span class="text-sm text-yellow-500 mt-2">Status: Low</span>
      </div>
      <!-- Blood Type A- -->
      <div class="bg-white rounded-xl shadow-md p-4 flex flex-col items-center">
        <div class="w-16 h-16 rounded-full bg-red-100 flex items-center justify-center mb-2">
          <span class="text-red-600 text-2xl font-bold">A-</span>
        </div>
        <span class="text-lg font-semibold">18 Units</span>
        <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
          <div class="bg-red-500 h-2.5 rounded-full" style="width: 18%"></div>
        </div>
        <span class="text-sm text-red-500 mt-2">Status: Critical</span>
      </div>
      <!-- Blood Type B- -->
      <div class="bg-white rounded-xl shadow-md p-4 flex flex-col items-center">
        <div class="w-16 h-16 rounded-full bg-red-100 flex items-center justify-center mb-2">
          <span class="text-red-600 text-2xl font-bold">B-</span>
        </div>
        <span class="text-lg font-semibold">12 Units</span>
        <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
          <div class="bg-red-500 h-2.5 rounded-full" style="width: 12%"></div>
        </div>
        <span class="text-sm text-red-500 mt-2">Status: Critical</span>
      </div>
      <!-- Blood Type AB- -->
      <div class="bg-white rounded-xl shadow-md p-4 flex flex-col items-center">
        <div class="w-16 h-16 rounded-full bg-red-100 flex items-center justify-center mb-2">
          <span class="text-red-600 text-2xl font-bold">AB-</span>
        </div>
        <span class="text-lg font-semibold">7 Units</span>
        <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
          <div class="bg-red-600 h-2.5 rounded-full" style="width: 7%"></div>
        </div>
        <span class="text-sm text-red-500 mt-2">Status: Critical</span>
      </div>
      <!-- Blood Type O- -->
      <div class="bg-white rounded-xl shadow-md p-4 flex flex-col items-center">
        <div class="w-16 h-16 rounded-full bg-red-100 flex items-center justify-center mb-2">
          <span class="text-red-600 text-2xl font-bold">O-</span>
        </div>
        <span class="text-lg font-semibold">32 Units</span>
        <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
          <div class="bg-yellow-500 h-2.5 rounded-full" style="width: 32%"></div>
        </div>
        <span class="text-sm text-yellow-500 mt-2">Status: Low</span>
      </div>
    </div>
  </div>
  <div class="text-center mt-13 mb-12">
    <a href="donasi.html" class="bg-red-600 text-white py-4 px-8 rounded-lg shadow-lg hover:bg-red-700 transition duration-300 font-bold text-lg">
      Donate Now
    </a>
  </div>
</section>
<footer class="bg-gray-800 text-white py-12 px-4">
  <div class="container mx-auto">
  <div class="grid md:grid-cols-3 gap-8">
      <div>
      <h3 class="text-xl font-bold mb-4">About PMI Blood Heroes</h3>
      <p class="text-gray-300">
          An interactive educational platform that aims to raise awareness about the importance of blood donation
          among teenagers, especially middle and high school students.
      </p>
      </div>
      <div>
      <h3 class="text-xl font-bold mb-4">Important Links</h3>
      <ul class="space-y-2 text-gray-300">
          <li><a href="#" class="hover:text-red-400 transition duration-300">Blood Donation Locations</a></li>
          <li><a href="#" class="hover:text-red-400 transition duration-300">Mobile Unit Schedule</a></li>
          <li><a href="#" class="hover:text-red-400 transition duration-300">Blood Donation FAQ</a></li>
          <li><a href="#" class="hover:text-red-400 transition duration-300">Blood Donation Requirements</a></li>
          <li><a href="#" class="hover:text-red-400 transition duration-300">Contact PMI</a></li>
      </ul>
      </div>
      <div>
      <h3 class="text-xl font-bold mb-4">Contact Us</h3>
      <ul class="space-y-2 text-gray-300">
          <li>
          <a href="#" class="hover:text-red-400 transition duration-300">
              <i class="far fa-envelope mr-2"></i> Email: info@pmibloodheroes.id
          </a>
          </li>
          <li>
          <a href="#" class="hover:text-red-400 transition duration-300">
              <i class="fas fa-phone mr-2"></i> Phone: 021-7992325
          </a>
          </li>
          <li>
          <a href="#" class="hover:text-red-400 transition duration-300">
              <i class="fab fa-instagram mr-2"></i> Instagram: @pmibloodheroes
          </a>
          </li>
          <li>
          <a href="#" class="hover:text-red-400 transition duration-300">
              <i class="fab fa-facebook mr-2"></i> Facebook: PMI Blood Heroes
          </a>
          </li>
          <li>
          <a href="#" class="hover:text-red-400 transition duration-300">
              <i class="fab fa-twitter mr-2"></i> Twitter: @PMIBloodHeroes
          </a>
          </li>
      </ul>
      </div>
  </div>
  <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
      <p>&copy; 2025 PMI Blood Heroes. All rights reserved.</p>
  </div>
  </div>
</footer>
    <script>
      // Mobile menu toggle
      document.querySelector("button.md\\:hidden").addEventListener("click", function () {
        const mobileMenu = document.getElementById("mobile-menu")
        mobileMenu.classList.toggle("hidden")
      })

      document.getElementById("sim-tab").classList.add("bg-gray-200");
      document.getElementById("quiz-tab").classList.remove("bg-gray-200");
      
      // Make simulation visible and quiz hidden
      document.getElementById("simulation").classList.remove("hidden");
      document.getElementById("quiz").classList.add("hidden");
      
      // Game tabs functionality - keep your existing event listeners
      document.getElementById("sim-tab").addEventListener("click", function () {
        // Show simulation, hide quiz
        document.getElementById("simulation").classList.remove("hidden");
        document.getElementById("quiz").classList.add("hidden");
        
        // Update tab appearance
        this.classList.add("bg-gray-200");
        document.getElementById("quiz-tab").classList.remove("bg-gray-200");
      });
      
      document.getElementById("quiz-tab").addEventListener("click", function () {
        // Hide simulation, show quiz
        document.getElementById("simulation").classList.add("hidden");
        document.getElementById("quiz").classList.remove("hidden");
        
        // Update tab appearance
        this.classList.add("bg-gray-200");
        document.getElementById("sim-tab").classList.remove("bg-gray-200");
      });

      // Quiz functionality
      document.addEventListener("DOMContentLoaded", function () {
        // Quiz questions
        const questions = [
          {
            question: "How long does it take for the body to replace plasma after donating blood?",
            options: ["12 hours", "24 hours", "36 hours", "48 hours"],
            correctAnswer: 1, // 24 hours
            explanation: "It typically takes about 24 hours for the body to replace plasma after a donation."
          },
          {
            question: "What blood type is known as the universal donor?",
            options: ["A+", "B-", "AB+", "O-"],
            correctAnswer: 3, // O-
            explanation:
              "O- is the universal donor because it can be given to any blood type recipient without causing a negative reaction."
          },
          {
            question: "How many lives can one blood donation potentially save?",
            options: ["1 life", "Up to 3 lives", "Up to 5 lives", "Up to 10 lives"],
            correctAnswer: 1, // Up to 3 lives
            explanation:
              "One unit of blood can be separated into red cells, plasma, and platelets, potentially saving up to 3 lives."
          }
        ]

        // Quiz variables
        let currentQuestion = 0
        let score = 0
        let selectedOption = null
        let userPoints = 304 // Initial points from the original HTML

        // Quiz elements
        const quizIntro = document.getElementById("quiz-intro")
        const quizContainer = document.getElementById("quiz-container")
        const quizResults = document.getElementById("quiz-results")
        const startQuizBtn = document.getElementById("start-quiz")
        const submitAnswerBtn = document.getElementById("submit-answer")
        const nextQuestionBtn = document.getElementById("next-question")
        const retryQuizBtn = document.getElementById("retry-quiz")
        const backToHomeBtn = document.getElementById("back-to-home")
        const questionText = document.getElementById("question-text")
        const optionsContainer = document.getElementById("options-container")
        const currentQuestionEl = document.getElementById("current-question")
        const totalQuestionsEl = document.getElementById("total-questions")
        const quizProgress = document.getElementById("quiz-progress")
        const quizScore = document.getElementById("quiz-score")
        const finalScore = document.getElementById("final-score")
        const resultMessage = document.getElementById("result-message")
        const pointsEarned = document.getElementById("points-earned")
        const pointsValue = document.getElementById("points-value")
        const feedbackAlert = document.getElementById("feedback-alert")
        const feedbackText = document.getElementById("feedback-text")
        const feedbackExplanation = document.getElementById("feedback-explanation")
        const pointsDisplay = document.querySelector(".quiz-points")

        // Set total questions
        totalQuestionsEl.textContent = questions.length

        // Start quiz
        startQuizBtn.addEventListener("click", function () {
          quizIntro.classList.add("hidden")
          quizContainer.classList.remove("hidden")
          loadQuestion()
        })

        // Load question
        function loadQuestion() {
          // Update question counter
          currentQuestionEl.textContent = currentQuestion + 1

          // Update progress bar
          const progressPercentage = ((currentQuestion + 1) / questions.length) * 100
          quizProgress.style.width = `${progressPercentage}%`

          // Reset selected option
          selectedOption = null

          // Load question text
          questionText.textContent = questions[currentQuestion].question

          // Load options
          optionsContainer.innerHTML = ""
          questions[currentQuestion].options.forEach((option, index) => {
            const optionDiv = document.createElement("div")
            optionDiv.className = "p-4 bg-gray-100 rounded-lg hover:bg-gray-200 cursor-pointer transition duration-300"
            optionDiv.dataset.index = index
            optionDiv.innerHTML = `<span class="font-medium">${String.fromCharCode(65 + index)}.</span> ${option}`

            // Add click event to select option
            optionDiv.addEventListener("click", function () {
              // Remove selected class from all options
              document.querySelectorAll("#options-container div").forEach((div) => {
                div.classList.remove("bg-red-100", "border-2", "border-red-600")
              })

              // Add selected class to clicked option
              this.classList.add("bg-red-100", "border-2", "border-red-600")

              // Update selected option
              selectedOption = parseInt(this.dataset.index)
            })

            optionsContainer.appendChild(optionDiv)
          })

          // Hide next button, show submit button
          submitAnswerBtn.classList.remove("hidden")
          nextQuestionBtn.classList.add("hidden")

          // Hide feedback
          feedbackAlert.classList.add("hidden")
        }

        // Submit answer
        submitAnswerBtn.addEventListener("click", function () {
          if (selectedOption === null) {
            alert("Please select an answer")
            return
          }

          const correctAnswer = questions[currentQuestion].correctAnswer

          // Check if answer is correct
          if (selectedOption === correctAnswer) {
            score++
            quizScore.textContent = score

            // Show correct feedback
            feedbackAlert.className = "mt-4 p-4 rounded-lg bg-green-100 text-green-800"
            feedbackText.textContent = "Correct! Well done!"
            feedbackExplanation.textContent = questions[currentQuestion].explanation
          } else {
            // Show incorrect feedback
            feedbackAlert.className = "mt-4 p-4 rounded-lg bg-red-100 text-red-800"
            feedbackText.textContent = "Incorrect!"
            feedbackExplanation.textContent = `The correct answer is: ${questions[currentQuestion].options[correctAnswer]}. ${questions[currentQuestion].explanation}`

            // Highlight correct answer
            document.querySelectorAll("#options-container div").forEach((div, index) => {
              if (index === correctAnswer) {
                div.classList.remove("bg-red-100", "border-red-600")
                div.classList.add("bg-green-100", "border-2", "border-green-600")
              }
            })
          }

          feedbackAlert.classList.remove("hidden")

          // Hide submit button, show next button or finish quiz
          submitAnswerBtn.classList.add("hidden")

          if (currentQuestion < questions.length - 1) {
            nextQuestionBtn.classList.remove("hidden")
          } else {
            // Show results after a short delay
            setTimeout(showResults, 1500)
          }
        })

        // Next question
        nextQuestionBtn.addEventListener("click", function () {
          currentQuestion++
          loadQuestion()
        })

        // Show results
        function showResults() {
          quizContainer.classList.add("hidden")
          quizResults.classList.remove("hidden")

          finalScore.textContent = score

          // Set result message based on score
          if (score === questions.length) {
            resultMessage.textContent = "Perfect! You're a blood donation expert!"
            // Award points for perfect score
            const pointsAwarded = 50
            userPoints += pointsAwarded
            pointsValue.textContent = pointsAwarded
            pointsEarned.classList.remove("hidden")
            pointsDisplay.textContent = `${userPoints} Points`
          } else if (score >= questions.length / 2) {
            resultMessage.textContent = "Good job! You know quite a bit about blood donation."
            // Award points for passing score
            const pointsAwarded = 20
            userPoints += pointsAwarded
            pointsValue.textContent = pointsAwarded
            pointsEarned.classList.remove("hidden")
            pointsDisplay.textContent = `${userPoints} Points`
          } else {
            resultMessage.textContent = "Keep learning! Check out our education section for more information."
            pointsEarned.classList.add("hidden")
          }
        }

        // Retry quiz
        retryQuizBtn.addEventListener("click", function () {
          // Reset quiz variables
          currentQuestion = 0
          score = 0
          quizScore.textContent = 0

          // Show quiz container, hide results
          quizResults.classList.add("hidden")
          quizContainer.classList.remove("hidden")

          // Load first question
          loadQuestion()
        })

        // Back to home
        backToHomeBtn.addEventListener("click", function () {
          // Reset quiz variables
          currentQuestion = 0
          score = 0
          quizScore.textContent = 0

          // Show intro, hide results
          quizResults.classList.add("hidden")
          quizIntro.classList.remove("hidden")
        })
      })

      // Wait for the DOM to be fully loaded before executing
      document.addEventListener("DOMContentLoaded", function () {
        // Get all tab buttons
        const tabButtons = document.querySelectorAll(".education-tab")

        // Get all content sections
        const contentSections = document.querySelectorAll(".education-content")

        // Function to handle tab switching
        function switchTab(tabId) {
          // Hide all content sections
          contentSections.forEach((section) => {
            section.classList.add("hidden")
          })

          // Remove active state from all tab buttons
          tabButtons.forEach((button) => {
            button.classList.remove("bg-gray-200")
            button.classList.add("hover:bg-gray-200")
          })

          // Show the selected content section
          const selectedContent = document.getElementById(`${tabId}-content`)
          if (selectedContent) {
            selectedContent.classList.remove("hidden")
          }

          // Set active state for the clicked tab button
          const activeButton = document.querySelector(`[data-tab="${tabId}"]`)
          if (activeButton) {
            activeButton.classList.add("bg-gray-200")
            activeButton.classList.remove("hover:bg-gray-200")
          }
        }

        // Add click event listeners to all tab buttons
        tabButtons.forEach((button) => {
          button.addEventListener("click", function () {
            const tabId = this.getAttribute("data-tab")
            switchTab(tabId)
          })
        })

      // Set the default active tab (first tab)
        const defaultTabId = tabButtons[0].getAttribute("data-tab")
        switchTab(defaultTabId)
      })
      // Profile dropdown functionality
      const profileButton = document.getElementById('profileButton');
      const dropdownMenu = document.getElementById('dropdownMenu');
      
      profileButton.addEventListener('click', function() {
          dropdownMenu.classList.toggle('hidden');
      });
      
      // Close the dropdown if clicked outside
      window.addEventListener('click', function(event) {
          if (!event.target.closest('.profile-container')) {
              dropdownMenu.classList.add('hidden');
          }
      });
      
      // Initialize the hero slider
    $(document).ready(function(){
      $('.hero-slider').slick({
        dots: true,
        infinite: true,
        speed: 800,
        fade: true,
        cssEase: 'linear',
        autoplay: true,
        autoplaySpeed: 5000,
        arrows: true,
        adaptiveHeight: false
      });
    });
    let selectedItem = null;
    let currentStage = 'donor';
    let gameState = {
      armCleaned: false,
      bloodCollected: false,
      testDone: false,
      bandageApplied: false,
      bloodGroupTested: false,
      bloodGroupIdentified: false,
      transfusionComplete: false,
      donorBloodType: 'A+', // Default blood type for donor
      recipientBloodType: 'A+', // Default blood type for recipient
      selectedGroupABO: '', // Untuk menyimpan pilihan golongan ABO
      selectedGroupRh: '', // Untuk menyimpan pilihan rhesus
  };

  // Elements
const controls = document.getElementById('controls');
const items = document.querySelectorAll('.item');
const messageEl = document.getElementById('message');
const nextBtn = document.getElementById('next-btn');
const alertEl = document.getElementById('alert');
const sceneContent = document.getElementById('scene-content');
const transitionOverlay = document.getElementById('transition-overlay');
const stageTitle = document.getElementById('stage-title');
const stageDesc = document.getElementById('stage-desc');

// Scene elements
const patientEl = document.querySelector('.patient');
const patientTargetEl = document.getElementById('patient-target');
const armEl = document.querySelector('.arm');
const cleanedAreaEl = document.getElementById('cleaned-area');
const bandageEl = document.getElementById('bandage');
const bloodSampleEl = document.getElementById('blood-sample');
const testResultEl = document.getElementById('test-result');
const bloodBagEl = document.getElementById('blood-bag');
const bloodTypeText = document.getElementById('blood-type-text');
const laboratoryEl = document.getElementById('laboratory');
const transfusionRoomEl = document.getElementById('transfusion-room');
const transfusionTubeEl = document.getElementById('transfusion-tube');
const dropZoneEl = document.getElementById('drop-zone');
const instructionText = document.getElementById('instruction-text');
const transfusionStandEl = document.getElementById('transfusion-stand');

// Lab test elements
const labBloodSampleEl = document.getElementById('lab-blood-sample');
const testPlateA = document.getElementById('test-plate-a');
const testPlateB = document.getElementById('test-plate-b');
const testPlateRh = document.getElementById('test-plate-rh');
const resultA = document.getElementById('result-a');
const resultB = document.getElementById('result-b');
const resultRh = document.getElementById('result-rh');
const bloodTypeSelection = document.getElementById('blood-type-selection');
const aboButtons = document.getElementById('abo-buttons');
const rhButtons = document.getElementById('rh-buttons');
const confirmSelection = document.getElementById('confirm-selection');
const testResultDisplay = document.getElementById('test-result-display');
const resultText = document.getElementById('result-text');

// Blood group selection elements
const btnA = document.getElementById('btn-a');
const btnB = document.getElementById('btn-b');
const btnAB = document.getElementById('btn-ab');
const btnO = document.getElementById('btn-o');
const btnRhPos = document.getElementById('btn-rh-pos');
const btnRhNeg = document.getElementById('btn-rh-neg');
const btnConfirm = document.getElementById('btn-confirm');

// Setup
setupEventListeners();

// Setup initial controls for donor stage
updateControlsForStage('donor');

function setupEventListeners() {
    // Arm interaction
    armEl.addEventListener('click', () => {
        if (selectedItem) {
            useItemOnArm(selectedItem.dataset.item);
        }
    });

    // Next button
    nextBtn.addEventListener('click', moveToNextStage);

    // Blood group selection buttons
    btnA.addEventListener('click', () => selectBloodGroup('A'));
    btnB.addEventListener('click', () => selectBloodGroup('B'));
    btnAB.addEventListener('click', () => selectBloodGroup('AB'));
    btnO.addEventListener('click', () => selectBloodGroup('O'));
    btnRhPos.addEventListener('click', () => selectRhFactor('+'));
    btnRhNeg.addEventListener('click', () => selectRhFactor('-'));
    btnConfirm.addEventListener('click', confirmBloodGroup);
}

function updateControlsForStage(stage) {
    controls.innerHTML = ''; // Clear existing controls
    
    switch (stage) {
        case 'donor':
            addControlItem('cotton', 'Kapas Alkohol', `
                <svg viewBox="0 0 60 60">
                    <rect x="10" y="25" width="40" height="10" rx="5" fill="#e0e0e0" stroke="#bdbdbd" stroke-width="1" />
                    <circle cx="10" cy="30" r="8" fill="#fff" stroke="#bdbdbd" />
                    <circle cx="50" cy="30" r="8" fill="#fff" stroke="#bdbdbd" />
                    <text x="30" y="55" text-anchor="middle" font-size="8">Alcohol Cotton</text>
                </svg>
            `);
            
            addControlItem('syringe', 'Jarum Suntik', `
                <svg viewBox="0 0 60 60">
                    <rect x="10" y="25" width="30" height="10" rx="2" fill="#bbdefb" stroke="#1976d2" />
                    <rect x="40" y="27" width="15" height="6" fill="#e0e0e0" stroke="#bdbdbd" />
                    <path d="M55 30 L60 30" stroke="#bdbdbd" stroke-width="1" />
                    <rect x="5" y="27" width="5" height="6" fill="#42a5f5" />
                    <text x="30" y="55" text-anchor="middle" font-size="8">Syringe</text>
                </svg>
            `);
            
            addControlItem('bandage', 'Plester', `
                <svg viewBox="0 0 60 60">
                    <rect x="10" y="25" width="40" height="10" rx="2" fill="#ffe0b2" stroke="#ff9800" />
                    <rect x="20" y="25" width="20" height="10" fill="#f5f5f5" />
                    <line x1="15" y1="20" x2="15" y2="40" stroke="#ff9800" stroke-width="1" />
                    <line x1="25" y1="20" x2="25" y2="40" stroke="#ff9800" stroke-width="1" />
                    <line x1="35" y1="20" x2="35" y2="40" stroke="#ff9800" stroke-width="1" />
                    <line x1="45" y1="20" x2="45" y2="40" stroke="#ff9800" stroke-width="1" />
                    <text x="30" y="55" text-anchor="middle" font-size="8">Plaster</text>
                </svg>
            `);
            break;
            
        case 'transfusion':
            addControlItem('bag', 'Kantung Darah', `
                <svg viewBox="0 0 60 60">
                    <path d="M15 15 L45 15 L45 40 Q30 50 15 40 Z" fill="#e53935" stroke="#7b1fa2" stroke-width="1" />
                    <circle cx="30" cy="25" r="6" fill="white" stroke="#7b1fa2" stroke-width="1" />
                    <text x="30" y="28" text-anchor="middle" font-size="6">A+</text>
                    <text x="30" y="55" text-anchor="middle" font-size="8">Blood Bladder</text>
                </svg>
            `);
            break;
    }
    
    setupControlItemListeners();
}

function addControlItem(itemName, title, svgContent) {
    const itemDiv = document.createElement('div');
    itemDiv.className = 'item';
    itemDiv.dataset.item = itemName;
    itemDiv.title = title;
    itemDiv.innerHTML = svgContent;
    controls.appendChild(itemDiv);
}

function setupControlItemListeners() {
    const items = document.querySelectorAll('.item');
    items.forEach(item => {
        item.addEventListener('click', () => selectItem(item));
    });
}

function selectItem(item) {
    items.forEach(i => i.classList.remove('selected'));
    item.classList.add('selected');
    selectedItem = item;
    messageEl.textContent = `You select ${item.title || item.dataset.item}. Click on the patient's arm to use.`;
}

function useItemOnArm(item) {
    switch (item) {
        case 'cotton':
            if (!gameState.armCleaned) {
                cleanArm();
            } else {
                showAlert('Arms have been cleaned');
            }
            break;
        case 'syringe':
            if (gameState.armCleaned && !gameState.bloodCollected) {
                collectBlood();
            } else if (!gameState.armCleaned) {
                showAlert('Clean the arm first with an alcohol swab');
            } else {
                showAlert('Blood has been taken');
            }
            break;
        case 'bandage':
            if (gameState.bloodCollected && !gameState.bandageApplied) {
                applyBandage();
            } else if (!gameState.bloodCollected) {
                showAlert('Draw blood first');
            } else {
                showAlert('Plaster has been applied');
            }
            break;
        case 'test':
            if (gameState.bloodCollected && !gameState.testDone) {
                testBlood();
            } else if (!gameState.bloodCollected) {
                showAlert('Draw blood first');
            } else {
                showAlert('The test has been done');
            }
            break;
        case 'bag':
            if (currentStage === 'transfusion') {
                useBloodBag();
            } else {
                showAlert('Blood bags will be used at the transfusion stage');
            }
            break;
    }
}

function cleanArm() {
    cleanedAreaEl.style.display = 'block';
    gameState.armCleaned = true;
    messageEl.textContent = 'The arm has been cleaned. Draw blood with a syringe.';
    showAlert('Arm has been cleaned!');
}

function collectBlood() {
    bloodSampleEl.style.display = 'block';
    gameState.bloodCollected = true;
    messageEl.textContent = 'Blood has been drawn. Put a plaster on the arm.';
    showAlert('Blood successfully drawn!');

    const bloodSample = document.getElementById('blood-sample');
    bloodSample.style.top = '100px';
    bloodSample.style.right = '100px';
}

function applyBandage() {
    bandageEl.style.display = 'block';
    gameState.bandageApplied = true;
    messageEl.textContent = 'The plaster has been applied. Click the “Next” button to perform the blood test.';
    showAlert('Plaster applied, blood donation completed blood donation completed!');
    nextBtn.disabled = false;
}

function testBlood() {
    testResultEl.style.display = 'block';
    testResultEl.innerHTML = `<strong>Blood Type:</strong><br>${gameState.donorBloodType}`;
    gameState.testDone = true;
    messageEl.textContent = 'Blood tests have been conducted. Blood type has been identified.';
    showAlert(`Blood type identified: ${gameState.donorBloodType}`);
    nextBtn.disabled = false;
}

function useBloodBag() {
    messageEl.textContent = 'Attach the blood bag to the infusion pole and connect it to the patient..';
    showAlert('Use blood bags for transfusion');
}

function moveToNextStage() {
    nextBtn.disabled = true;

    if (currentStage === 'donor' && gameState.bandageApplied) {
        showTransition('Laboratorium', 'Time to determine your blood type at the lab.');
        setTimeout(() => {
            currentStage = 'laboratory';
            startLaboratoryStage();
            controls.style.display = 'none'; // Hide controls for laboratory stage
            updateControlsForStage('laboratory');
        }, 2000);
    }
    else if (currentStage === 'laboratory' && gameState.bloodGroupIdentified) {
        showTransition('Transfusi Darah', 'Use blood bags for transfusion to patients.');
        setTimeout(() => {
            currentStage = 'transfusion';
            startTransfusionStage();
            updateControlsForStage('transfusion');
        }, 2000);
    }
    else if (currentStage === 'transfusion' && gameState.transfusionComplete) {
        showTransition('Selesai', 'Blood transfusion has been successfully performed.');
        setTimeout(() => {
            messageEl.textContent = 'Simulator is complete. Refresh the page to start over.';
            showAlert('Blood transfusion was successful!');
        }, 2000);
    }
}

function startLaboratoryStage() {
  // Sembunyikan elemen pasien
  patientEl.style.display = 'none';
  bloodSampleEl.style.display = 'none';
  testResultEl.style.display = 'none';
  
  // Tampilkan adegan laboratorium
  laboratoryEl.style.display = 'block';
  
  // Pastikan kontainer terkait pemilihan golongan darah tersembunyi di awal
  const bloodTypeSelection = document.getElementById('blood-type-selection-container');
  if (bloodTypeSelection) {
      bloodTypeSelection.classList.add('hidden');
  }
  
  const testResultDisplay = document.getElementById('test-result-display');
  if (testResultDisplay) {
      testResultDisplay.classList.add('hidden');
  }
  
  // Hasilkan golongan darah acak untuk level ini
  generateRandomBloodType();
  
  // Tampilkan pesan yang menginstruksikan pengguna
  messageEl.textContent = 'Blood type test by dropping a blood sample onto the testing plate, click on the blood sample.';
  
  // Jadikan sampel darah laboratorium dapat diklik
  labBloodSampleEl.style.cursor = 'pointer';
  labBloodSampleEl.addEventListener('click', startBloodGroupTest);
}

// Fungsi untuk menghasilkan golongan darah acak
function generateRandomBloodType() {
  // Definisikan kemungkinan golongan darah
  const bloodGroups = ['A', 'B', 'AB', 'O'];
  const rhFactors = ['+', '-'];
  
  // Pilih secara acak
  const randomBloodGroup = bloodGroups[Math.floor(Math.random() * bloodGroups.length)];
  const randomRhFactor = rhFactors[Math.floor(Math.random() * rhFactors.length)];
  
  // Tetapkan golongan darah acak ke gameState
  gameState.donorBloodType = randomBloodGroup + randomRhFactor;
  
  console.log("Blood type produced: " + gameState.donorBloodType);
}


function startBloodGroupTest() {
  let dropCount = 0;
  const plates = [testPlateA, testPlateB, testPlateRh];

  function createBloodDrop(plate) {
      const dropEl = document.createElement('div');
      dropEl.className = 'blood-drop-animation';
      
      const plateRect = plate.getBoundingClientRect();
      const labRect = laboratoryEl.getBoundingClientRect();
      
      dropEl.style.left = (plateRect.left - labRect.left + plateRect.width / 2) + 'px';
      dropEl.style.top = (plateRect.top - labRect.top) + 'px';
      
      laboratoryEl.appendChild(dropEl);
      
      setTimeout(() => {
          laboratoryEl.removeChild(dropEl);
          
          const plateType = plate.dataset.type;
          let reactionResult = false;
          
          // Tentukan reaksi berdasarkan golongan darah yang ditetapkan
          if (plateType === 'A') {
              // Reaksi penggumpalan terjadi jika golongan darah mengandung A (A atau AB)
              reactionResult = gameState.donorBloodType.includes('A');
          } else if (plateType === 'B') {
              // Reaksi penggumpalan terjadi jika golongan darah mengandung B (B atau AB)
              reactionResult = gameState.donorBloodType.includes('B');
          } else if (plateType === 'Rh') {
              // Reaksi penggumpalan terjadi jika golongan darah Rh positif
              reactionResult = gameState.donorBloodType.includes('+');
          }
          
          showCoagulation(plateType, reactionResult);
          
          dropCount++;
          if (dropCount === plates.length) {
              setTimeout(() => {
                  showBloodTypeSelectionInterface();
              }, 1000);
          }
      }, 1000);
  }

  plates.forEach((plate, index) => {
      setTimeout(() => {
          createBloodDrop(plate);
      }, index * 1000);
  });

  labBloodSampleEl.style.cursor = 'default';
  labBloodSampleEl.removeEventListener('click', startBloodGroupTest);
  messageEl.textContent = 'Conduct blood type tests...';
}

function showCoagulation(plateType, isCoagulated) {
  let resultEl;
  switch (plateType) {
      case 'A': resultEl = resultA; break;
      case 'B': resultEl = resultB; break;
      case 'Rh': resultEl = resultRh; break;
  }

  const offset = plateType === 'A' ? -120 : plateType === 'B' ? 0 : 120;
  const color = isCoagulated ? '#4caf50' : '#f44336';

  resultEl.style.display = 'block';
  
  if (isCoagulated) {
      resultEl.innerHTML = `
          <circle cx="${offset}" cy="0" r="15" fill="${color}" fill-opacity="0.5" />
          <path d="M${offset-10} 0 L${offset} 10 L${offset+10} -10" 
              stroke="${color}" stroke-width="2" fill="none" />
      `;
      showAlert(`Terjadi penggumpalan reagen ${plateType}`, 'success');
  } else {
      resultEl.innerHTML = `
          <circle cx="${offset}" cy="0" r="15" fill="${color}" fill-opacity="0.5" />
          <path d="M${offset-10} -10 L${offset+10} 10" stroke="${color}" stroke-width="2" />
          <path d="M${offset-10} 10 L${offset+10} -10" stroke="${color}" stroke-width="2" />
      `;
      showAlert(`No clumping of reagents ${plateType}`, 'error');
  }
}


function showBloodTypeSelectionInterface() {
  // Perbarui pesan
  messageEl.textContent = 'Based on the test results, determine the blood type.';
  
  // Dapatkan container pemilihan golongan darah
  const selectionContainer = document.getElementById('blood-type-selection-container');
  if (selectionContainer) {
      // Tambahkan petunjuk tentang cara menentukan golongan darah
      // Cek jika petunjuk belum ada
      if (!selectionContainer.querySelector('.helper-box')) {
          const helperBox = document.createElement('div');
          helperBox.className = 'helper-box';
          helperBox.innerHTML = `
              <h4 class="font-bold text-blue-700 mb-2">How to determine blood type:</h4>
              <ul class="list-disc list-inside text-gray-700 space-y-1">
                  <li>If clumping occurs in reagent A: contains antigen A/li>
                  <li>If clumping occurs in reagent B: contains antigen A B</li>
                  <li>If clumping occurs in the Rh reagent: Rhesus positive (+)</li>
                  <li>Type A: clumping only in reagent A</li>
                  <li>Type B: clumping only in reagent B</li>
                  <li>Type AB: clumping in reagents A and B</li>
                  <li>Type O: no clumping in reagents A and B</li>
              </ul>
          `;
          
          // Sisipkan petunjuk di awal container
          selectionContainer.insertBefore(helperBox, selectionContainer.firstChild);
      }
      
      // Tampilkan container dengan animasi
      selectionContainer.classList.remove('hidden');
      selectionContainer.classList.add('fade-in');
      
      // Inisialisasi tombol jika belum dilakukan
      if (!selectionContainer.dataset.initialized) {
          // Event listener untuk tombol golongan darah
          document.querySelectorAll('.blood-type-btn').forEach(btn => {
              btn.addEventListener('click', function() {
                  const type = this.textContent;
                  selectBloodGroup(type);
              });
          });
          
          // Event listener untuk tombol rhesus
          document.querySelectorAll('.rh-btn').forEach(btn => {
              btn.addEventListener('click', function() {
                  const rhFactor = this.textContent.includes('+') ? '+' : '-';
                  selectRhFactor(rhFactor);
              });
          });
          
          // Event listener untuk tombol konfirmasi
          const confirmBtn = document.getElementById('btn-confirm');
          if (confirmBtn) {
              confirmBtn.addEventListener('click', confirmBloodGroup);
          }
          
          // Tandai sebagai sudah diinisialisasi
          selectionContainer.dataset.initialized = "true";
      }
  }
}

function selectBloodGroup(group) {
  // Reset semua tombol golongan darah ke style default
  document.querySelectorAll('.blood-type-btn').forEach(btn => {
      btn.classList.remove('selected');
  });
  
  // Tambahkan class selected ke tombol yang diklik
  const btnId = {
      'A': 'btn-a',
      'B': 'btn-b',
      'AB': 'btn-ab',
      'O': 'btn-o'
  }[group];
  
  const btn = document.getElementById(btnId);
  if (btn) {
      btn.classList.add('selected');
  }
  
  // Simpan golongan darah yang dipilih
  gameState.selectedGroupABO = group;
  
  // Periksa apakah seleksi sudah lengkap
  checkSelectionComplete();
}


function selectRhFactor(factor) {
  // Reset semua tombol rhesus ke style default
  document.querySelectorAll('.rh-btn').forEach(btn => {
      btn.classList.remove('selected');
  });
  
  // Tambahkan class selected ke tombol yang diklik
  const btnId = factor === '+' ? 'btn-rh-pos' : 'btn-rh-neg';
  const btn = document.getElementById(btnId);
  if (btn) {
      btn.classList.add('selected');
  }
  
  // Simpan faktor Rh yang dipilih
  gameState.selectedGroupRh = factor;
  
  // Periksa apakah seleksi sudah lengkap
  checkSelectionComplete();
}

function checkSelectionComplete() {
  // Jika golongan darah dan faktor Rh keduanya sudah dipilih, tampilkan tombol konfirmasi
  if (gameState.selectedGroupABO && gameState.selectedGroupRh) {
      const confirmSelection = document.getElementById('confirm-selection');
      if (confirmSelection) {
          confirmSelection.classList.remove('hidden');
          // Tambahkan animasi fade-in
          confirmSelection.classList.add('fade-in');
      }
  }
}

function confirmBloodGroup() {
  // Gabungkan golongan darah dan faktor Rh yang dipilih
  const selectedBloodType = gameState.selectedGroupABO + gameState.selectedGroupRh;
  
  // Periksa apakah pilihan benar
  const isCorrect = selectedBloodType === gameState.donorBloodType;
  
  if (isCorrect) {
      // Sembunyikan interface pemilihan golongan darah
      const bloodTypeSelection = document.getElementById('blood-type-selection-container');
      if (bloodTypeSelection) {
          bloodTypeSelection.classList.add('hidden');
      }
      
      // Tampilkan hasil tes dengan animasi
      const resultDisplay = document.getElementById('test-result-display');
      if (resultDisplay) {
          resultDisplay.classList.remove('hidden');
          resultDisplay.classList.add('success-pulse');
          
          // Perbarui elemen teks hasil
          document.getElementById('result-text').textContent = `Blood Type: ${selectedBloodType}`;
          
          // Perbarui tampilan golongan darah
          const resultBloodType = document.getElementById('result-blood-type');
          if (resultBloodType) {
              resultBloodType.textContent = selectedBloodType;
          }
      }
      
      // Tampilkan pesan berhasil
      showAlert('Blood group identification is correct!', 'success');
      
      // Perbarui status game dan pesan
      gameState.bloodGroupIdentified = true;
      messageEl.textContent = 'Golongan darah telah diidentifikasi dengan benar. Klik tombol "Lanjut" untuk melakukan transfusi.';
      
      // Aktifkan tombol lanjut
      nextBtn.disabled = false;
  } else {
      // Tampilkan pesan kesalahan
      showAlert(`Incorrect blood type identification! Please try again.`, 'error');
      
      // Reset pilihan tapi biarkan interface tetap terbuka
      resetBloodTypeSelection();
      
      // Tambahkan animasi flash error
      const bloodTypeContainer = document.getElementById('blood-type-selection-container');
      if (bloodTypeContainer) {
          bloodTypeContainer.classList.add('flash-error');
          setTimeout(() => {
              bloodTypeContainer.classList.remove('flash-error');
          }, 600);
      }
  } 
  messageEl.textContent = 'Incorrect blood type identification. Please try again based on the test results.';
    
  // Animasi petunjuk visual tambahan
  createHelpfulHint();
}

// Fungsi untuk membuat petunjuk visual ketika pengguna salah
function createHelpfulHint() {
  // Cek apakah elemen petunjuk sudah ada
  let hintElement = document.querySelector('.blood-type-hint');
  
  // Jika sudah ada, hapus dulu untuk menghindari duplikasi
  if (hintElement) {
      hintElement.remove();
  }
  
  // Buat elemen petunjuk baru
  hintElement = document.createElement('div');
  hintElement.className = 'blood-type-hint bg-yellow-50 border-l-4 border-yellow-400 p-3 mb-4 animate-pulse';
  
  // Dapatkan golongan darah yang benar
  const correctBloodType = gameState.donorBloodType;
  
  // Petunjuk berdasarkan hasil tes (tanpa memberikan jawaban langsung)
  let hintText = '<h4 class="font-bold text-yellow-700 mb-1">Hint:</h4><ul class="list-disc list-inside text-gray-700 space-y-1">';
  
  // Petunjuk untuk golongan ABO
  if (correctBloodType.includes('A') && correctBloodType.includes('B')) {
      // AB
      hintText += '<li>Clumping occurs <strong>both reagents A and B</strong></li>';
  } else if (correctBloodType.includes('A')) {
      // A
      hintText += '<li>Clumping occurs in <strong>reagent A only</strong></li>';
  } else if (correctBloodType.includes('B')) {
      // B
      hintText += '<li>Clumping occurs in <strong>reagent B only</strong></li>';
  } else {
      // O
      hintText += '<li>No clumping occurs in <strong>reagents A or B</strong></li>';
  }
  
  // Petunjuk untuk Rhesus
  if (correctBloodType.includes('+')) {
      hintText += '<li>Clumping occurs in <strong>reagent Rh</strong></li>';
  } else {
      hintText += '<li>No clumping occurs in <strong>reagent Rh</strong></li>';
  }
  
  hintText += '</ul>';
  
  // Masukkan teks petunjuk ke elemen
  hintElement.innerHTML = hintText;
  
  // Masukkan elemen petunjuk ke dalam container
  const bloodTypeSelection = document.getElementById('blood-type-selection-container');
  if (bloodTypeSelection) {
      // Masukkan setelah elemen pertama (judul)
      const firstChild = bloodTypeSelection.firstChild;
      bloodTypeSelection.insertBefore(hintElement, firstChild.nextSibling);
  }
}


function resetBloodTypeSelection() {
  // Reset semua tombol golongan darah
  document.querySelectorAll('.blood-type-btn').forEach(btn => {
      btn.classList.remove('selected');
  });
  
  // Reset semua tombol rhesus
  document.querySelectorAll('.rh-btn').forEach(btn => {
      btn.classList.remove('selected');
  });
  
  // Sembunyikan tombol konfirmasi
  const confirmSelection = document.getElementById('confirm-selection');
  if (confirmSelection) {
      confirmSelection.classList.add('hidden');
  }
  
  // Reset nilai yang dipilih
  gameState.selectedGroupABO = '';
  gameState.selectedGroupRh = '';
}


// Update moveToNextStage to properly hide the HTML elements when moving to the next stage
function moveToNextStage() {
  nextBtn.disabled = true;

  if (currentStage === 'donor' && gameState.bandageApplied) {
      showTransition('Laboratorium', 'Saatnya menentukan golongan darah di laboratorium.');
      setTimeout(() => {
          currentStage = 'laboratory';
          startLaboratoryStage();
          controls.style.display = 'none'; // Sembunyikan kontrol untuk tahap laboratorium
          updateControlsForStage('laboratory');
      }, 2000);
  }
  else if (currentStage === 'laboratory' && gameState.bloodGroupIdentified) {
      // Sembunyikan elemen terkait pemilihan golongan darah
      const bloodTypeSelection = document.getElementById('blood-type-selection-container');
      if (bloodTypeSelection) {
          bloodTypeSelection.classList.add('hidden');
      }
      
      const testResultDisplay = document.getElementById('test-result-display');
      if (testResultDisplay) {
          testResultDisplay.classList.add('hidden');
      }
      
      showTransition('Transfusi Darah', 'Gunakan kantung darah untuk transfusi kepada pasien.');
      setTimeout(() => {
          currentStage = 'transfusion';
          startTransfusionStage();
          updateControlsForStage('transfusion');
      }, 2000);
  }
  else if (currentStage === 'transfusion' && gameState.transfusionComplete) {
      showTransition('Completed', 'Blood transfusion was successfully.');
      setTimeout(() => {
          messageEl.textContent = 'Simulator is complete. Refresh the page to start over.';
          showAlert('Blood transfusion was successful!', 'success');
      }, 2000);
  }
}

// Improved transfusion stage with enhanced drag and drop
function startTransfusionStage() {
    // Hide laboratory elements
    laboratoryEl.style.display = 'none';
    
    // Show transfusion scene
    fadeInElement(transfusionRoomEl);
    
    // Show blood bag with correct blood type
    bloodTypeText.textContent = gameState.donorBloodType;
    bloodBagEl.style.display = 'block';
    
    // Position the blood bag for better visibility - di posisi awal yang lebih terlihat
    bloodBagEl.style.position = 'absolute';
    bloodBagEl.style.top = '100px';
    bloodBagEl.style.left = '200px';
    bloodBagEl.style.cursor = 'grab';
    bloodBagEl.style.zIndex = '100';

    // Make sure the transfusion tube is hidden initially
    var tubeElement = document.getElementById('transfusion-tube');
    if (tubeElement) {
        tubeElement.style.display = 'none';
    }
    
    // Highlight drop zone for better visibility
    dropZoneEl.classList.add('drop-zone-highlight');
    
    // Make IV stand more prominent
    transfusionStandEl.classList.add('stand-highlight');
    
    messageEl.textContent = 'Attach the blood bag to the infusion pole by drag & drop.';
    showAlert('Drag the blood bag to the infusion pole to start the transfusion', 'info');
    
    // Setup drag and drop for blood bag
    setupBloodBagDragAndDrop();
}

// Drag and drop functionality
let isDragging = false;
let dragOffsetX = 0;
let dragOffsetY = 0;
let isTransfusionComplete = false;

function setupBloodBagDragAndDrop() {
    // Remove any existing event listeners
    bloodBagEl.removeEventListener('mousedown', startDrag);
    document.removeEventListener('mousemove', dragMove);
    document.removeEventListener('mouseup', dragEnd);
    
    // Add new mouse down event listener
    bloodBagEl.addEventListener('mousedown', startDrag);
    
    // Change cursor style when hovering over blood bag
    bloodBagEl.style.cursor = 'grab';
}

function startDrag(e) {
    if (currentStage !== 'transfusion' || isTransfusionComplete) return;
    
    // Change cursor style when dragging
    bloodBagEl.style.cursor = 'grabbing';
    
    // Get initial mouse position
    const rect = bloodBagEl.getBoundingClientRect();
    dragOffsetX = e.clientX - rect.left;
    dragOffsetY = e.clientY - rect.top;
    
    // Add move and end event listeners
    document.addEventListener('mousemove', dragMove);
    document.addEventListener('mouseup', dragEnd);
    
    isDragging = true;
    e.preventDefault();
}

function dragMove(e) {
    if (!isDragging) return;
    
    // Calculate new position relative to the scene content
    const sceneRect = sceneContent.getBoundingClientRect();
    const x = e.clientX - sceneRect.left - dragOffsetX;
    const y = e.clientY - sceneRect.top - dragOffsetY;
    
    // Move the blood bag with absolute positioning
    bloodBagEl.style.position = 'absolute';
    bloodBagEl.style.left = x + 'px';
    bloodBagEl.style.top = y + 'px';
    
    // Highlight drop zone when blood bag is being dragged
    const bagRect = bloodBagEl.getBoundingClientRect();
    const dropRect = dropZoneEl.getBoundingClientRect();
    
    if (isOverlapping(bagRect, dropRect)) {
        dropZoneEl.classList.add('drop-zone-active');
    } else {
        dropZoneEl.classList.remove('drop-zone-active');
    }
}

function dragEnd() {
    if (!isDragging) return;
    
    // Cek apakah dijatuhkan pada tiang
    const bagRect = bloodBagEl.getBoundingClientRect();
    const dropRect = dropZoneEl.getBoundingClientRect();
    
    // Reset drag state
    isDragging = false;
    document.removeEventListener('mousemove', dragMove);
    document.removeEventListener('mouseup', dragEnd);
    bloodBagEl.style.cursor = 'grab';
    
    if (isOverlapping(bagRect, dropRect)) {
        // Set transition untuk animasi smooth
        bloodBagEl.style.transition = 'all 0.3s ease';
        
        // Get scene dimensions for positioning
        const sceneRect = sceneContent.getBoundingClientRect();
        
        // Dapatkan posisi drop zone dengan tepat
        const dropZoneRect = dropZoneEl.getBoundingClientRect();
        
        // Hitung posisi yang lebih tepat untuk kantong darah
        // Sesuaikan dengan posisi drop zone
        const leftPos = (dropZoneRect.left - sceneRect.left) - 20; // Lebih ke kiri dari drop zone
        const topPos = (dropZoneRect.top - sceneRect.top) - 5; // Sedikit di atas drop zone
        
        // Posisikan kantong darah dengan tepat
        bloodBagEl.style.left = leftPos + 'px';
        bloodBagEl.style.top = topPos + 'px';
        
        // Pastikan kantung darah tegak
        bloodBagEl.style.transform = 'rotate(0deg)';
        
        // Tidak perlu drag lagi setelah berhasil ditempatkan
        bloodBagEl.removeEventListener('mousedown', startDrag);
        isTransfusionComplete = true;
        
        // Tampilkan selang transfusi dengan posisi yang tepat
        setTimeout(() => {
            var tubeElement = document.getElementById('transfusion-tube');
            
            if (!tubeElement) {
                tubeElement = document.createElementNS("http://www.w3.org/2000/svg", "path");
                tubeElement.id = "transfusion-tube";
                document.querySelector(".transfusion-room svg").appendChild(tubeElement);
            }
            
            tubeElement.setAttribute('stroke', '#e53935');
            tubeElement.setAttribute('stroke-width', '3');
            tubeElement.setAttribute('fill', 'none');
            tubeElement.setAttribute('stroke-dasharray', '5,5');
            
            // Sesuaikan path selang berdasarkan posisi baru kantong darah
            const startX = leftPos + 40; // Mulai dari sisi kanan kantong darah
            const startY = topPos + 40; // Mulai dari bagian bawah kantong darah
            
            // Path yang disesuaikan untuk terhubung dari kantong ke pasien
            tubeElement.setAttribute('d', `M${startX} ${startY} C${startX} ${startY+50}, 400 250, 240 300`);
            tubeElement.style.display = 'block';

            // Make drop zone invisible but still functional
            dropZoneEl.style.opacity = '0';
            dropZoneEl.style.pointerEvents = 'auto';

            // Make instruction text invisible
            instructionText.style.opacity = '0'; 
            instructionText.style.pointerEvents = 'auto';

            startTransfusionAnimation(tubeElement);
        }, 300);
        
        // Tampilkan pesan sukses
        showAlert('Blood bag successfully placed!', 'success');
        messageEl.textContent = 'Blood transfusion is in progress....';
    } else {
        // Jika tidak di drop zone, kembali ke posisi awal
        bloodBagEl.style.transition = 'all 0.3s ease';
        bloodBagEl.style.left = '200px';
        bloodBagEl.style.top = '100px';
        
        // Hapus highlight drop zone
        dropZoneEl.classList.remove('drop-zone-active');
    }
}

function isOverlapping(rect1, rect2) {
    return !(rect1.right < rect2.left || 
        rect1.left > rect2.right || 
        rect1.bottom < rect2.top || 
        rect1.top > rect2.bottom);
}

// PERBAIKAN: Menerima element sebagai parameter
function startTransfusionAnimation(tubeElement) {
    // Add blood flow animation class to tube
    tubeElement.classList.add('blood-flow');
    
    // Perbaiki CSS untuk animasi blood flow agar lebih jelas terlihat
    const style = document.createElement('style');
    style.textContent = `
        .blood-flow {
            stroke-dasharray: 10, 5;
            animation: flow 5s linear infinite;
        }
        
        @keyframes flow {
            from {
                stroke-dashoffset: 1000;
            }
            to {
                stroke-dashoffset: 0;
            }
        }
        
        @keyframes pulse {
            from { r: 5; fill: #e53935; }
            to { r: 7; fill: #c62828; }
        }
    `;
    document.head.appendChild(style);
    
    // Create drip animation if exists
    const drip = document.getElementById('drip');
    if (drip) {
        drip.style.display = 'block';
    } else {
        // Buat elemen tetesan jika belum ada
        const dropSvg = document.querySelector(".transfusion-room svg");
        const newDrip = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        newDrip.id = "drip";
        newDrip.setAttribute('cx', parseFloat(bloodBagEl.style.left) + 20);
        newDrip.setAttribute('cy', '145');
        newDrip.setAttribute('r', '3');
        newDrip.setAttribute('fill', '#e53935');
        
        // Tambahkan animasi ke tetesan
        const animate1 = document.createElementNS("http://www.w3.org/2000/svg", "animate");
        animate1.setAttribute('attributeName', 'cy');
        animate1.setAttribute('from', '145');
        animate1.setAttribute('to', '180');
        animate1.setAttribute('dur', '1s');
        animate1.setAttribute('repeatCount', 'indefinite');
        
        const animate2 = document.createElementNS("http://www.w3.org/2000/svg", "animate");
        animate2.setAttribute('attributeName', 'opacity');
        animate2.setAttribute('from', '1');
        animate2.setAttribute('to', '0');
        animate2.setAttribute('dur', '1s');
        animate2.setAttribute('repeatCount', 'indefinite');
        
        newDrip.appendChild(animate1);
        newDrip.appendChild(animate2);
        dropSvg.appendChild(newDrip);
    }
    
    // Update patient appearance gradually
    setTimeout(() => {
        // Cari elemen pasien dan ubah warnanya secara bertahap
        const patientElements = document.querySelectorAll('.patient-in-bed rect, .patient-in-bed circle');
        patientElements.forEach(el => {
            if (el.getAttribute('fill') === '#f5cba7') {
                el.style.transition = 'fill 2s';
                el.style.fill = '#ffccbc';
            }
        });
        
        // Tambahkan animasi pada transfusion point
        const transfusionPoint = document.getElementById('transfusion-point');
        if (transfusionPoint) {
            transfusionPoint.style.animation = 'pulse 1s infinite alternate';
        }
        
        // Perbarui pesan di panel bawah
        showAlert('Transfusi darah berhasil!', 'success');
        // Perbarui pesan di panel bawah
        showAlert('Transfusi darah berhasil!', 'success');
        messageEl.textContent = 'The blood transfusion is complete. Click the “Next” button to end the simulation.';
        
        // Enable dan tampilkan tombol "Lanjut"
        gameState.transfusionComplete = true;
        nextBtn.disabled = false;
        nextBtn.style.display = 'block';
        nextBtn.style.opacity = '1';
    } , 2000);}

  function fadeInElement(element) {
      element.style.display = 'block';
      element.classList.add('fade-in');
  }
  
  function showTransition(title, description) {
      stageTitle.textContent = title;
      stageDesc.textContent = description;
      transitionOverlay.classList.add('active');
      
      setTimeout(() => {
      transitionOverlay.classList.remove('active');
      }, 2000);
  }
  
  function showAlert(message, type = 'info') {
      alertEl.textContent = message;
      alertEl.style.display = 'block';
      
      // Set color based on type
      switch(type) {
      case 'success':
          alertEl.style.backgroundColor = '#4CAF50';
          break;
      case 'error':
          alertEl.style.backgroundColor = '#f44336';
          break;
      default:
          alertEl.style.backgroundColor = '#2196F3';
      }
      
      setTimeout(() => {
      alertEl.style.display = 'none';
      }, 3000);
  }
  </script>
  </body>
</html>